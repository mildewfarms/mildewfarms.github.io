<html>
<head>
  <title>Listing 4 - The Perl Journal, Fall 1999</title>
  <meta name="generator" content=
  "HTML Tidy for Linux/x86 (vers 12 April 2005), see www.w3.org">
  <meta name="vscategory" content="Perl">
  <meta name="vsisbn" content="">
  <meta name="vstitle" content=
  "Client-Server Applications - Listing 4">
  <meta name="vsauthor" content="Lincoln D. Stein">
  <meta name="searchdescription" content="">
  <meta name="vsimprint" content="The Perl Journal">
  <meta name="vspublisher" content="Earthweb">
  <meta name="vspubdate" content="Fall 1999">
  <!-- update listing #, listing title, and issue  -->

</head>

<body bgcolor="#FFFFFF" text="#000000" link="#DD0000" vlink=
"#DD0000" alink="#DD0000" leftmargin="0" topmargin="0" marginwidth=
"0" marginheight="0">
  <!-- update listing #, listing title, and issue throughout the table -->

  <table cellspacing="0" cellpadding="5" width="100%" border="0">
    <tr align="left" valign="top">
      <td bgcolor="#CCCC99">
        <table width="100%">
          <tr>
            <td valign="top" bgcolor="#CCCC99" nowrap><font face=
            "Arial,Helvetica" size="+1">Listing 4.</font><br>
            <font size="-1" face="Arial,Helvetica" color=
            "#663300"><b>&nbsp;</b></font><br>
            <font size="-1" face="Arial,Helvetica" color=
            "#663300"><i>Lincoln D. Stein</i></font></td>

            <td valign="top" bgcolor="#CCCC99"><font size="-1"
            face="Arial,Helvetica" color="#663300">Client-Server
            Applications<br>
            The Perl Journal, Fall 1999</font></td>
          </tr>
        </table>
      </td>
    </tr>

    <tr>
      <td>
        <table width="100%">
          <tr>
            <td width="5%" bgcolor="#FFFFFF">&nbsp;</td>

            <td bgcolor="#FFFFFF">
              <font color="#000000">
              <!-- insert code listing or table here --></font>
              <pre>
<font color="#000000"> 
  0  package Chatbot::Eliza::Server;
  1  use Chatbot::Eliza;
    
  2  @ISA = 'Chatbot::Eliza';
    
  3  sub command_interface {
  4    my ($self,$in,$out) = @_;
  5    die "usage: Chatbot::Eliza::Server-&gt;new(\$input_handle,\$output_handle)"
  6        unless $in &amp;&amp; $out;
  7    my ($user_input, $previous_user_input, $reply);
      
  8    $self-&gt;botprompt($self-&gt;name . ":\t");  # Set Eliza's prompt 
  9    $self-&gt;userprompt("you:\t");           # Set user's prompt
    
 10    # Print an initial greeting
 11    $out-&gt;print ($self-&gt;botprompt,
 12                 $self-&gt;{initial}-&gt;[ int rand scalar @{ $self-&gt;{initial} } ],
 13                 "\n");
    
 14    while (1) {
 15      $out-&gt;print ($self-&gt;userprompt);
 16      $previous_user_input = $user_input;
 17      chomp( $user_input = $in-&gt;getline ); 
    
 18      # If the user wants to quit,
 19      # print out a farewell and quit.
 20      if ($self-&gt;_testquit($user_input) ) {
 21          $reply = $self-&gt;{final}-&gt;[ int rand scalar @{ $prompt-&gt;{final} } ];
 22          $out-&gt;print ($self-&gt;botprompt,$reply,"\n");
 23          last;
 24      } 
    
 25      # Invoke the transform method
 26      # to generate a reply.
 27      $reply = $self-&gt;transform( $user_input );
    
 28      # Print the actual reply
 29      $out-&gt;print ($self-&gt;botprompt,$reply,"\n");
 30    }
 31  }
    
 32  1;
</font>
</pre><!--  end code listing  -->
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html>
