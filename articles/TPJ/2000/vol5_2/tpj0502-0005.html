<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>GDGRAPH3D - The Perl Journal, Summer 2000</title>
  <meta name="generator" content=
  "HTML Tidy for Linux/x86 (vers 12 April 2005), see www.w3.org">
  <meta name="vscategory" content="Perl">
  <meta name="vsisbn" content="">
  <meta name="vstitle" content="GDGRAPH3D">
  <meta name="vsauthor" content="Jeremy Wadsack">
  <meta name="searchdescription" content="">
  <meta name="vsimprint" content="The Perl Journal">
  <meta name="vspublisher" content="Earthweb">
  <meta name="vspubdate" content="Summer 2000">
  <!-- always update the article title and issue -->

  <!-- end head -->
  <!-- link to the previous and next documents relative to the current document -->
</head>

<body>
  <font face="verdana" size="1">Issue 18, Summer 2000</font>

  <h2 align="center">GDGRAPH3D</h2>

  <h4 align="left"><i>Jeremy Wadsack</i></h4>
  <!-- packages described, if necessary -->

  <div align="center">
    <table width="400" border="1" cellspacing="0" cellpadding="5">
      <tr>
        <td bgcolor="#CCCC99" align="middle">
        <b>&nbsp;&nbsp;Packages:&nbsp;&nbsp;</b></td>
      </tr>

      <tr>
        <td>
        GDGraph3d,&nbsp;GD::Graph,&nbsp;GD,&nbsp;GDTextUtil,&nbsp;PDL
        ......... CPAN<br>
        zlib ............
        ftp://ftp.freesoftware.com/pub/infozip/zlib/zlib.tar.gz<br>
        libpng ....................................
        ftp://ftp.cdrom.com/pub/png/src/<br>
        lttf ......................
        http://freetype.sourceforge.net/download.html<br>
        jpeg-6b .......................................
        ftp://ftp.uu.net/graphics/jpeg/<br>
        libgd ..................................
        ftp://ftp.boutell.com/pub/boutell/gd/</td>
      </tr>
    </table>
  </div>

  <p>When it comes to understanding large amounts of data, we
  humans have two stages of interpretation. First, we analyze the
  data, organizing it in myriad ways to find the hidden
  relationships, quantities, and trends that deliver meaning to our
  world. Second, we present it somehow, often by displaying it
  visually. With graphs and charts we can visualize trends,
  understand relationships, and compare quantities at a glance.</p>

  <p><font face="verdana" size="-2"><b>Figure 1:</b> Sample
  GDGraph3d output.</font><br>
  <img src="images/tpj0502-0005-01.gif" alt=
  "Sample GDGraph3d output" width="300" height="200"></p>

  <p>Over the course of the last year I developed the Perl package
  GDGraph3d as part of a statistics presentation tool I work on for
  analyzing the huge amounts of data available to and generated by
  web servers. Report Magic for Analog, our companion presentation
  package for the Analog web site statistics analysis tool, uses
  GDGraph3d to present Analog's log file analyses in a friendly
  manner with graphs like Figure 1.</p>

  <p>GDGraph3d is an extension to Martien Verbruggen's GD::Graph
  package. GD::Graph draws only two-dimensional images (except for
  the <tt>3d</tt> option on pie charts), but provides the basis for
  data management, labeling, legends and other routine graph
  operations that are common to both packages.</p>

  <h3>Using GDGraph3d</h3>

  <p>In order to use GDGraph3d, you will need to install several
  packages: at a minimum, the GD::Graph and GD Perl modules, and
  the <i>libgd</i> library. Fortunately for Windows and Mac users,
  GD and the <i>libgd</i> library are included in ActivePerl and
  MacPerl. If you have ActivePerl, you can use the PPM or VPM tool
  to acquire the latest version of GD. With PPM you can simply use
  this command:</p>
  <pre>
  &gt; ppm install GD
</pre>

  <p>On Unix (and Unix-like) systems, the installation is a lot
  more complex. <i>libgd</i> is a C library that itself depends on
  the <i>libpng</i> and <i>zlib</i> libraries. If you want TrueType
  font support (recommended if you're using a character set other
  than Latin-1 or Latin-2) you'll need FreeType's <i>lttf</i>. In
  order to build GD on top of <i>libgd</i>, you will also need to
  install the <i>jpeg-6b</i> library. Complete details for
  installing this are listed on the <i>libgd</i> website (<a href=
  "http://www.boutell.com/gd/" target=
  "resource window">http://www.boutell.com/gd/</a>); a summary is
  available in the sidebar, <i>Installing</i> GD.</p>

  <p>Installing GD::Graph and GDGraph3d should be fairly simple.
  Both are located on CPAN and can be found through the CPAN search
  engine at <a href="http://search.cpan.org" target=
  "resource window">http://search.cpan.org</a>. You'll also need to
  install the GDTextUtil package, which you can find there as
  well.</p>

  <p>Once you have all the proper modules and libraries installed,
  it's time to write some code and make some pictures. Listing 1
  contains a simple script to generate the graph in Figure 2. We'll
  go through the script line by line.</p>

  <p><font face="verdana" size="-2"><b>Figure 2:</b> The output of
  Listing 1.</font><br>
  <img src="images/tpj0502-0005-02.gif" alt="output of Listing 1"
  width="300" height="200"></p><a href="tpj0502-0005a.html" target=
  "resource window">Listing 1: A sample GDGraph3D program.</a>

  <p>The first line tells Perl which graph module you want to use.
  With both GD::Graph and GDGraph3d, you <tt>use</tt> the type of
  graph you wish to make. So in this instance, since we are making
  a line graph, we use <tt>GD::Graph::lines3d</tt>.</p>

  <p>The next set of lines creates a data structure containing the
  data to be graphed. GDGraph3d uses an array of an array of
  values. The first row holds the labels for the x -axis, and the
  subsequent rows are the data for each line of the graph. In this
  example, we've coded the values by hand, but in a real
  application, you'd get these from a database, an external file,
  or some other source. Check out the GD::Graph::Data class for
  methods that make it easy to read data from delimited text files
  and DBI sources.</p>

  <p>On line 14 we create a new graph "<tt>lines3d</tt>" object.
  GDGraph3d objects cannot be reused - you create a new one for
  each set of data you wish to plot.</p>

  <p>Lines 17 to 21 set several self-explanatory options for the
  graph. GDGraph3d supports all the options that GD::Graph does
  (and there are many), as well as a few options specifically for
  three-dimensional output (like the z-directional depth of the
  lines). We'll go into more detail below about using options to
  improve the look of the graph.</p>

  <p>Line 24 tells GDGraph3d to plot the data to an image. The
  <tt>plot</tt> method returns a reference to a GD image object. If
  you wish, you can further process this image with additional GD
  methods.</p>

  <p>Because the GD library can output in different formats (GIF,
  PNG, JPEG, and so on) GDGraph3d offers a method to return the
  default format. For new installations, this call will return
  <tt>png</tt>. If you happen to have an old version of GD and
  <i>libgd</i> on your system, this returns the patent-infringing
  <tt>gif</tt>.</p>

  <p>Now, using the format that GDGraph3d found for us, we can
  write the contents of the image to a file on the system: in our
  example, either <tt>sample.png</tt> or <tt>sample.gif</tt>. The
  <tt>binmode</tt> call is included for systems that make a
  distinction between binary and text files (like Windows). On
  other systems, this has no effect.</p>

  <p>GD::Graph and GDGraph3d allow you to adjust the graph in many
  ways. We'll start by setting some colors. GDGraph3d has 29
  predefined colors (white, lgray, gray, dgray, black, lblue, blue,
  dblue, gold, lyellow, yellow, dyellow, lgreen, green, dgreen,
  lred, red, dred, lpurple, purple, dpurple, lorange, orange, pink,
  dpink, marine, cyan, lbrown, and dbrown) or can accept any RGB
  color defined with HTML syntax. To set the colors, we'll add some
  key/value pairs to the <tt>$graph-&gt;set()</tt> statement so
  that it looks like this:</p>
  <pre>
 # Set some labels
 $graph-&gt;set( 
     x_label  =&gt; 'Month, 1999',
     y_label  =&gt; 'Revenue ($US)',
       title  =&gt; 'Monthly revenue for 1999',
       dclrs  =&gt; ['#9999CC', '#CCCC66', '#339900', 
                        '#990000', '#FFCC33'],
      boxclr  =&gt; '#FFFFCC',
  long_ticks  =&gt; 1,
 );
</pre>

  <p><tt>dclrs</tt> sets a list of colors to use for each data set,
  <tt>boxclr</tt> sets the color to use in the background of the
  plot, and setting <tt>long_ticks</tt> to a true value tells
  GDGraph3d to draw a grid on the background (connecting all the
  ticks). See Figure 3 for the results.</p>

  <p><font face="verdana" size="-2"><b>Figure 3:</b> Choosing
  colors.</font><br>
  <img src="images/tpj0502-0005-03.gif" alt="Choosing colors"
  width="300" height="200"></p>

  <p>Now let's work on the fonts. GDGraph3d uses GD's font
  mechanisms (through GD::Text). This means, that by default, you
  can choose one of five predefined fonts, defined in the GD::Font
  class (<tt>GD::Font-&gt;Small</tt>, <tt>GD::Font-&gt;Large</tt>,
  <tt>GD::Font-&gt;MediumBold</tt>, <tt>GD::Font-&gt;Tiny</tt>, or
  <tt>GD::Font-&gt;Giant</tt>). If you built <i>libgd</i> with
  TrueType support (ActiveState's build includes this on Win32),
  then you can also use TrueType fonts (if you give the full
  pathname to the font). For this example, we'll use built-in fonts
  and insert these three lines after the <tt>$graph-&gt;set()</tt>
  call to specify the fonts to use for the title above the graph
  and the labels on each axis:</p>
  <pre>
 $graph-&gt;set_title_font(   GD::Font-&gt;Giant );
 $graph-&gt;set_x_label_font( GD::Font-&gt;MediumBold );
 $graph-&gt;set_y_label_font( GD::Font-&gt;MediumBold );
</pre>

  <p>We'd also like to add a legend to the graph so that the people
  who see it know what each line refers to. First, we add these
  key/value pairs to the <tt>$graph-&gt;set()</tt> statement:</p>
  <pre>
  legend_placement  =&gt; 'RC',
  legend_spacing    =&gt; 10,
</pre>

  <p>(<tt>RC</tt> means "Right Center".) We also add these two new
  statements later to create the legend, by defining the labels
  associated with each data set and setting the font for the legend
  text.</p>
  <pre>
# Define a legend
$graph-&gt;set_legend( 'Affiliate A', 'Affiliate B', 'Affiliate C', 
                  'Affiliate D', 'Affiliate E' ); 
$graph-&gt;set_legend_font( GD::Font-&gt;MediumBold ); 
</pre>

  <p>The result is shown in Figure 4.</p>

  <p><font face="verdana" size="-2"><b>Figure 4:</b> Specifying
  fonts and adding a legend.</font><br>
  <img src="images/tpj0502-0005-04.gif" alt=
  "Specifying fonts and adding legend" width="300" height=
  "200"></p>

  <p>There is a lot more you can do with GDGraph3d. For example,
  you could format the y -axis labels to include the "$" sign, or
  you could adjust the maximum y -value by hand to better fit the
  data, as shown in Figure 5. Read the documentation in GD::Graph
  and GDGraph3d for details on the options and settings
  available.</p>

  <h3>What The Future Holds</h3>

  <p>Like many Perl modules, GDGraph3d is a work in progress. One
  of the first improvements I would like to make is to add shading
  to the faces. I'd also like to include a drop-shadow option for
  the pie charts. The drop-shadow rendering could be improved to
  look more shadow-like, although it would slow down graph
  generation. I would also like to complete three-dimensional
  versions of the point, area, and point-and-line graphs available
  in GD::Graph. Finally, the ultimate goal of GDGraph3d would be to
  handle the projections for any viewing angle.</p>

  <p><font face="verdana" size="-2"><b>Figure 5:</b> Bells and
  whistles.</font><br>
  <img src="images/tpj0502-0005-05.gif" alt="Bells and whistles"
  width="300" height="200"></p>

  <p>GDGraph3d isn't meant to meet the needs of all applications.
  There are now a number of graphing modules available for Perl,
  mainly differentiated by which graphics library they require
  under the hood. GDGraph3d also does not provide for graphing of
  true three-dimensional data - it merely graphs two-dimensional
  data with a three-dimensional extrusion. For real
  three-dimensional rendering, users should use the Perl Data
  Language (PDL) and its associated graphing and rendering
  modules.</p><a href="tpj0502-0005b.html" target=
  "resource window">Installing GD</a>

  <p>_ _END_ _<br>
  <br></p>
  <hr>

  <p><i>Jeremy Wadsack (<a href=
  "mailto:jwadsack@wadsack-allen.com">jwadsack@wadsack-allen.com</a>)
  is a web site analysis consultant for the Wadsack-Allen Digital
  Group (http://www.wadsack-allen.com/digitalgroup/), a division of
  the Wadsack-Allen publishing company in Flagstaff,
  Arizona.</i></p><!-- end of article -->
  <!-- link to the previous and next documents relative to the current document -->
  <!-- end of file -->
</body>
</html>
