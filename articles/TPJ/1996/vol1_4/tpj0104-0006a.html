<html>
<head>
  <title>Listing 1: get_weather - The Perl Journal, Winter 1996</title>
  <meta name="generator" content=
  "HTML Tidy for Linux/x86 (vers 12 April 2005), see www.w3.org">
  <meta name="vscategory" content="Perl">
  <meta name="vsisbn" content="">
  <meta name="vstitle" content="Listing 1. get_weather">
  <meta name="vsauthor" content="Lincoln Stein">
  <meta name="searchdescription" content="">
  <meta name="vsimprint" content="The Perl Journal">
  <meta name="vspublisher" content="Earthweb">
  <meta name="vspubdate" content="Winter 1996">
  <!-- update listing #, listing title, and issue  -->

</head>

<body bgcolor="#FFFFFF" text="#000000" link="#DD0000" vlink=
"#DD0000" alink="#DD0000" leftmargin="0" topmargin="0" marginwidth=
"0" marginheight="0">
  <!-- update listing #, listing title, and issue throughout the table -->

  <table cellspacing="0" cellpadding="5" width="100%" border="0">
    <tr align="left" valign="top">
      <td bgcolor="#CCCC99">
        <table width="100%">
          <tr>
            <td valign="top" bgcolor="#CCCC99" nowrap><font face=
            "Arial,Helvetica" size="+1">Listing 1.</font><br>
            <font size="-1" face="Arial,Helvetica" color=
            "#663300"><b>get_weather: A Perl script that fetches
            the current weather report.</b></font><br>
            <font size="-1" face="Arial,Helvetica" color=
            "#663300"><i>Lincoln Stein</i></font></td>

            <td valign="top" bgcolor="#CCCC99"><font size="-1"
            face="Arial,Helvetica" color="#663300">CGI Programming:
            The LWP Library<br>
            The Perl Journal, Winter 1996</font></td>
          </tr>
        </table>
      </td>
    </tr>

    <tr>
      <td>
        <table width="100%">
          <tr>
            <td width="5%" bgcolor="#FFFFFF">&nbsp;</td>

            <td bgcolor="#FFFFFF">
              <font color="#000000">
              <!-- insert code listing or table here --></font>
              <pre>
<font color="#000000">01 #!/usr/bin/perl 
02 # File: get_weather 
03 
04 use LWP::UserAgent; 
05 use HTML::Parse; 
06 use HTML::FormatText; 
07 
08 # options 
09 $CITY = shift || 'BOS'; 
10 $URL = 'http://www.nnic.noaa.gov/cgi-bin/netcast.do-it'; 
11 $OPTIONS =
     'city=on&amp;area=Local+Forecast&amp;match=Strong+Match&amp;html=text+only+format'; 
12 
13 $agent = new LWP::UserAgent; 
14 $request = new HTTP::Request('GET', "$URL?state=$CITY&amp;$OPTIONS"); 
15 $response = $agent-&gt;request($request); 
16 die "Couldn't get URL. Status code = ", $response-&gt;code 
17 unless $response-&gt;isSuccess; 
18 
19 $parse_tree = parse_html($response-&gt;content); 
20 $formatter = new HTML::FormatText; 
21 @lines = split("\n",$formatter-&gt;format($parse_tree)); 
22 foreach (@lines) { 
23     print $_, "\n" if /^\s*[-]+\w/../^\s*[-]+$/; 
24 }
</font>
</pre><!--  end code listing  -->
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html>
