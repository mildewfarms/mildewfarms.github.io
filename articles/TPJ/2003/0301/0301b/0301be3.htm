<html><head><title>Jan03: Session Management with CGI::Session</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; The Perl Journal--><pre>    sub authenticate {        my ($cgi, $dbh, $session) = @_;        my $login = $cgi-&gt;param("login")    or return;        my $psswd = $cgi-&gt;param("password") or return;        my $profile = $dbh-&gt;selectrow_hashref(qq|            SELECT * FROM profile WHERE login=? AND 			  psswd=PASSWORD(?)|, undef, $login, $psswd);        # logged in successfully!        if ( $profile ) {            $session-&gt;param(MEMBER_PROFILE =&gt; $profile,                            logged_in      =&gt; 1);            $session-&gt;clear( ["login_failures"] );            return $profile;        }        # if login failed, increment the counter:        my $i = $session-&gt;param( "login_failures" ) || 0;        $session-&gt;param( login_failures =&gt; ++$i );        $session-&gt;clear( ["logged_in"] );        return;    }</pre><h4>Example 3: The authenticate() function.</h4><a href="0301b.htm#re3">Back to Article</a></body></html>