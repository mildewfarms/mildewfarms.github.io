


<html>
<head>
<title>May, 2005: C++/CLI: Value Class Types</title>
</head>

<body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000">
<!--Copyright &#169; C/C++ Users Journal-->






<h4>Listing 4</h4>
<pre>
using namespace System;
public value class Complex
{
    double real;
    double imag;
public:
    static initonly Complex i;
    static Complex()
    {
        i = Complex(0.0, 1.0);
    }
    Complex(double real)
    {
        this-&gt;real = real;
        this-&gt;imag = 0.0;
    }
    Complex(double real, double imag)
    {
        this-&gt;real = real;
        this-&gt;imag = imag;
    }
    property double Real
    {
        double get() { return real; }
        void set(double value) { real = value; }
    }
    property double Imag
    {
        double get() { return imag; }
        void set(double value) { imag = value; }
    }
    static Complex operator+(Complex z1, Complex z2)
    {
        return Complex(z1.real + z2.real, z1.imag + z2.imag);
    }
    static Complex operator-(Complex z1, Complex z2)
    {
        return Complex(z1.real - z2.real, z1.imag - z2.imag);
    }
    String^ ToString() override
    {
        if (imag &lt; 0.0)
        {                                                       
            return String::Format("({0} - {1}i)", real, -imag);
        }
        else if (1.0/imag == Double::NegativeInfinity)
        {
            return String::Format("({0} - 0.0i)", real);
        }
        else
        {
            return String::Format("({0} + {1}i)", real, +imag);
        }
    }
};
</pre>



</body>
</html>
