<HTML><HEAD>
<TITLE>September 2002 C++ .NET Solutions/Icon Browser: An Exercise in Resource Management/Figure 7</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 7: Enumerating icon resources in a library</A></h4>
<pre>
__gc class LibraryUser
{
    void UseLibrary()
    {
        Using&lt;Library*&gt; library =
            new Library(S"C:\\Windows\\Explorer.exe", 
                        WindowsAPI::LOAD_LIBRARY_AS_DATAFILE);

        library-&gt;EnumResourceNames(WindowsAPI::RT_GROUP_ICON,
            new WindowsAPI::EnumResNameProc(this, Callback),
            System::IntPtr::Zero);
    }

    bool Callback(System::IntPtr hModule,
                  System::IntPtr pType,
                  System::IntPtr pName,
                  System::IntPtr param)
    {
        // Use the icon resource

        return true; // to keep enumerating
    }
};
&#151; End of Figure &#151;</pre></body></html>
