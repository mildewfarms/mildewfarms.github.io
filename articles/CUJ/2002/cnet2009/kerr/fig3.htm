<HTML><HEAD>
<TITLE>September 2002 C++ .NET Solutions/Icon Browser: An Exercise in Resource Management/Figure 3</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Figure 3: First pass at writing a Managed C++ class to wrap library functions</A></h4>
<pre>
__gc class Library
{
public:

    Library(System::String* strFileName,
            WindowsAPI::DWORD dwFlags)
    {
        m_hModule = WindowsAPI::LoadLibraryEx(strFileName,
                                              System::IntPtr::Zero,
                                              dwFlags);
    }

    ~Library()
    {
        WindowsAPI::FreeLibrary(m_hModule);
    }

private:

    System::IntPtr m_hModule;

};
&#151; End of Figure &#151;</pre></body></html>
