<HTML><HEAD>
<TITLE>July 2002/The Application Watchman Class/Listing 6</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 6: Demonstrates heap corruption</A></h4>
<pre>
void MemoryCorruption(void)
{
  AppWatchMan  myAppWatchMan;
  myAppWatchMan.DoRounds("Before Test",
                            AWM::BEGIN_CONF_CHECK);

  char* pBufferA = new char [sizeof("Hello World")];
  cout &lt;&lt; "** Write 1 char past end of pBufferA!" &lt;&lt; endl;
  strcpy(pBufferA, "Hello World!");  // oops!
  delete [] pBufferA;

  char* pBufferB = new char [sizeof("Goodbye")];
  cout &lt;&lt; "** Write 1 char past end of pBufferB!" &lt;&lt; endl;
  strcpy(pBufferB, "Goodbye!");  // oops!
  // delete [] pBufferB;  // intentional

  myAppWatchMan.DoRounds("After Test", AWM::END_CONF_CHECK);

}
&#151; End of Listing &#151;</pre></body></html>
