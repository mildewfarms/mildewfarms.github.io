<HTML>
<HEAD>
<TITLE>Threading from Managed C++</TITLE>
</HEAD><BODY>
<h4>Listing 4: Inventing lock blocks and synchronizing on them </h4>
<Pre>
#using &lt;mscorlib.dll&gt;
using namespace System;
using namespace System::Threading;

__gc class Th04
{
private:
   static Object *fileLock = new Object;

public:
   static void M1()
   {
      // ...
      Monitor::Enter(fileLock);
      try
      {
         // read from a file
      }
      __finally
      {
         Monitor::Exit(fileLock);
      }
      // ...
   }

   static void M2()
   {
      // ...
      Monitor::Enter(fileLock);
      try
      {
         // update a display
      }
      __finally
      {
         Monitor::Exit(fileLock);
      }
      // ...
   }
};<B>
</b>&#151; End of Listing &#151;</pre>
</BODY>
</HTML>
