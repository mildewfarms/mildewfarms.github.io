<HTML><HEAD>
<TITLE>March 2003/Quick and Easy XML Creation with C++ Classes/Listing 2</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 2: Code for creating XML in <a href="web0303c_fig2.htm" target="_blank">Figure 
  2</a></A></h4>
<pre>
WXMLStackDocument Doc();  // Unicode version  

Doc.pushProcessingInstruction(L&quot;xml&quot;) =
 L&quot;version='1.0' encoding='UTF-16'&quot;;  
Doc.pop();  // pops the processing instruction  

Doc.pushElement(L&quot;Book&quot;);  
Doc.top().createAttribute(L&quot;Status&quot;) = L&quot;BackOrdered&quot;;  

Doc.pushElement(L&quot;Title&quot;) = L&quot;Doing It - Sail Around the World&quot;;  
Doc.pop();  // pops &lt;Title&gt;  

Doc.pushElement(L&quot;PubId&quot;) = 736;  
Doc.pop();  // pops &lt;PubId&gt;  

Doc.pushElement(L&quot;Price&quot;).createAttribute(L&quot;Currency&quot;) = L&quot;USD&quot;;  
Doc.top().setValue(19.99, 2);  // Assign 19.99 to &lt;Price&gt;  
Doc.pop();  // pops &lt;Price&gt;  

Doc.pushElement(L&quot;Author&quot;);  
Doc.pushElement(L&quot;LastName&quot;) = L&quot;Ference&quot;;  
Doc.pop();  // pops &lt;LastName&gt;  

Doc.pushElement(L&quot;FirstName&quot;).setValue(L&quot;Jeff&quot;);  
Doc.popAll(); // Pops off all remaining nodes  
</pre>
</body>
</html>
