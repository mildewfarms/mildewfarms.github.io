<html>
<head>
<title>FOR_EACH and LOCK</title>
</head>

<body>


<h4>Listing 3:	move_next() <i>helper function.</i></h4>

<pre>
template&lt; typename T &gt;
bool move_next( T &amp; var, IEnumerator * pEnum )
{
    if ( ! pEnum-&gt;MoveNext() )
        return false;
    var = __try_cast&lt;T&gt;( pEnum-&gt;Current );
    return true;
}
</pre>
</body>
</html>
