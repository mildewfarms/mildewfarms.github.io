<html>
<head>
<title>FOR_EACH and LOCK</title>
</head>

<body>


<h4>Listing 2:	<i>First crack at </i>FOR_EACH.</h4>

<pre>
#define FOR_EACH( type, var, coll ) \
    if( IEnumerator *_num_ = (coll)-&gt;GetEnumerator() ) \
        for ( type var; /* magic happens here */; )
</pre>
</body>
</html>
