<html>
<head>
<title>Generic Object-Oriented Differential Equation Integrators</title>

</head>

<body><h4>Listing 6:	<i>A convergence test corresponding to the differential equations shown in Listing 3.</i></h4>

<pre>
bool approx_equal(const valarray&lt;complex&lt;double&gt; &gt; &amp;x1,
                  const valarray&lt;complex&lt;double&gt; &gt; &amp;x2)
{
    const double rtol2 = 1e-8;
    bool ap_eq(true);
    for (unsigned int loop=0; loop&lt;x1.size(); loop++)
        ap_eq = ap_eq &amp;&amp;
            (norm(x1[loop]-x2[loop])
         &lt; rtol2*norm(x1[loop]+x2[loop]));
    return(ap_eq);
}
</pre>
</body>
</html>
