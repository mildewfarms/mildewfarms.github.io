<html>
<head>
<title>August, 2004: Template-Generated JNI</title>
</head>

<body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000">
<!--Copyright &#169; C/C++ Users Journal-->






<h4>Listing 1</h4>
<pre>
template &lt;typename T&gt; T* jobj_wrapper::arr_specific_return( ) const
{
    jboolean copied = false;
    jsize len = _env-&gt;GetArrayLength( (jarray) _jobj );
    if( !_env-&gt;ExceptionCheck() ){
        if( _env-&gt;IsInstanceOf( _jobj, java::classArrayOfIntegers ) ){ 
// if it is Java's int[] array
        jint* jarr = _env-&gt;GetIntArrayElements( (jintArray) _jobj, &amp;copied );
        DEBUG_OUT( "\n jint* jarr = " &lt;&lt; jarr;)
        // copy will be created if only needed
        T* pT = get_new_copy_on_need( jarr, len, newed, typeTp );
        data = new Impl&lt; T* &gt;( pT, jarr, newed, len );
      }
 ... 
        return &amp;((Impl&lt; vector&lt;T&gt; &gt;*)data)-&gt;data[0];
    }
 ... 
}
</pre>



</body>
</html>
