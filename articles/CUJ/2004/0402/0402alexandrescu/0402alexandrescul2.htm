<html><head><title>February 04: Smart Pointers Reloaded (III): Construction Trackingsmart_ptr initialization</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; C/C++ Users Journal--><h4>Listing 2:	<i>The resource_manager class in action.</i></h4><pre><b>template</b> &lt;<b>class</b> storage_policy, <b>class</b> ownership_policy&gt;<b>class</b> resource_manager   : <b>public</b> optimally_inherit&lt;storage_policy, ownership_policy&gt;::type{   ...   ~resource_manager() {      <b>if</b> (!ownership_policy::release(get_impl(*this))) {         storage_policy::release();      }   }};<b>template</b> &lt;   <b>typename</b> T,   <b>template</b> &lt;typename&gt; <b>class</b> ownership_policy = ref_counted,   <b>template</b> &lt;typename&gt; <b>class</b> conversion_policy = disallow_conversion,   <b>template</b> &lt;typename&gt; <b>class</b> checking_policy = assert_check,   <b>template</b> &lt;typename&gt; <b>class</b> storage_policy = scalar_storage&gt;<b>class</b> smart_ptr   : <b>public</b> optimally_inherit&lt;     resource_manager&lt;        storage_policy&lt;T&gt;,        ownership_policy&lt;T&gt;     &gt;,     optimally_inherit&lt;        checking_policy&lt;T&gt;,        conversion_policy&lt;T&gt;     &gt;   &gt;{ ...};</body></html>