<html><head><title>May 04: Mapping recls to COM Collections Delving into the Component Object Model</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; C/C++ Users Journal--><h4>Listing 6:	get_DirectoryParts() <i>method.</i></h4><pre>STDMETHODIMP FileEntry::get_DirectoryParts(LPUNKNOWN *pVal){  typedef CComObject&lt;DirectoryPartsCollection&gt; DirPartsColl_t;  DirPartsColl_t  *pcoll;  HRESULT         hr = DirPartsColl_t::CreateInstance(&amp;pcoll);  if(SUCCEEDED(hr))  {    directory_parts_type  dirParts( m_entry-&gt;directoryParts.begin                                  , m_entry-&gt;directoryParts.end);    pcoll-&gt;AddRef();    hr = pcoll-&gt;Init(static_cast&lt;IFileEntry*&gt;(this), dirParts);    if(SUCCEEDED(hr))    {      hr = pcoll-&gt;QueryInterface(pVal);    }    pcoll-&gt;Release();  }  return hr;}</body></html>