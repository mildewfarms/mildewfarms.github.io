<html><head><title>May 04: Mapping recls to COM Collections Delving into the Component Object Model</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; C/C++ Users Journal--><h4>Listing 8:	CComBSTR.</h4><pre>struct dirparts_proxy_traits{  static CComVariant make_value(const recls_strptrs_t &ptr)  {    CComVariant var;    var.vt = VT_BSTR;# ifdef RECLS_CHAR_TYPE_IS_CHAR    var.bstrVal = ::SysAllocStringLen(winstl::a2w(ptr.begin,                      ptr.end - ptr.begin), ptr.end - ptr.begin);# elif defined(RECLS_CHAR_TYPE_IS_WCHAR)    var.bstrVal = ::SysAllocStringLen( ptr.begin, ptr.end - ptr.begin);# endif /* RECLS_CHAR_TYPE_IS_WCHAR */    return var;  }};</body></html>