<html><head><title>May 04: Mapping recls to COM Collections Delving into the Component Object Model</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; C/C++ Users Journal--><h4>Listing 5:	EnumEntry <i>definition.</i></h4><pre>class ATL_NO_VTABLE EnumEntry    : public CComObjectRootEx&lt;CComSingleThreadModel&gt;  , public IEnumVARIANT  , public IEnumFileEntry{public:  EnumEntry()    : m_bIEnumVARIANT(false)    , m_bIEnumFileEntry(false)  {}  ~EnumEntry();  ...  static HRESULT WINAPI QueryFunc(void *pv,REFIID riid, LPVOID *ppv,DWORD dw);DECLARE_PROTECT_FINAL_CONSTRUCT()BEGIN_COM_MAP(EnumEntry)  COM_INTERFACE_ENTRY2(IUnknown, IEnumVARIANT)  COM_INTERFACE_ENTRY_FUNC(IID_IEnumVARIANT, 0, EnumEntry::QueryFunc)  COM_INTERFACE_ENTRY_FUNC(IID_IEnumFileEntry, 0, EnumEntry::QueryFunc)END_COM_MAP()// IEnumXXXXpublic:    STDMETHOD(Skip)(/* [in] */ ULONG celt);    STDMETHOD(Reset)();// IEnumVARIANTpublic:    STDMETHOD(Next)(/* [in] */ ULONG celt,          /* [length_is][size_is][out] */ VARIANT *rgVar,          /* [out] */ ULONG *pceltFetched);    STDMETHOD(Clone)(/* [out] */ IEnumVARIANT **ppEnum);// IEnumFileEntrypublic:    STDMETHOD(Next)(/* [in] */ ULONG celt,          /* [length_is][size_is][out] */ PFILEENTRY *rgVar,          /* [out] */ ULONG *pceltFetched);    STDMETHOD(Clone)(/* [out] */ IEnumFileEntry **ppEnum);// Implementationprivate:  HRESULT DoSkip();  HRESULT DoNext(VARIANT *pvar);  HRESULT DoNext(PFILEENTRY *pvar);// Membersprivate:  SearchInfo  m_info;  bool        m_bIEnumVARIANT;  bool        m_bIEnumFileEntry;};</body></html>