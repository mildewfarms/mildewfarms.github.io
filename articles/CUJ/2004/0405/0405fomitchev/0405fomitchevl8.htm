<html><head><title>May 04: </title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; C/C++ Users Journal--><h4>Listing 8:	<i>The</i> Epilog() <i>method.</i></h4><pre>HRESULT CUltraMaxService::Epilog(HRESULT hr){    if ( FAILED(hr) )    {        // Error information        CComPtr&lt;IErrorInfo&gt; Error;        if ( SUCCEEDED(GetErrorInfo(0, &amp;Error)) )           Error-&gt;GetDescription(&amp;m_ErrorDesc);        else            m_ErrorDesc = ::SysAllocString(L"Unknown error occurred.");    }    // Write object state to session    CComBSTR str;    str.Attach(m_pUltraMax-&gt;ToString());    m_spSession-&gt;SetVariable("state", CComVariant(str));    return hr;}</body></html>