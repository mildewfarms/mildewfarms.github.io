<html><head><title>May 04: </title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; C/C++ Users Journal--><h4>Listing 7:	<i>The</i> Prolog() <i>method.</i></h4><pre>HRESULT CUltraMaxService::Prolog(){    HRESULT hr;    CComVariant var;    // Retrieve existing or create new session    if ( SUCCEEDED(hr = EnsureSession()) &amp;&amp;        // Instantiate UltraMax COM component        SUCCEEDED(hr = m_pUltraMax.CreateInstance("UltraMax.UltraMax")))    {        CComVariant var;        // Retrieve object state from session storage        if ( SUCCEEDED(m_spSession-&gt;GetVariable("state", &amp;var)) )        {            var.ChangeType(VT_BSTR);            m_pUltraMax-&gt;InitFromString(var.bstrVal);        }        return S_OK;    }    else        return hr;}</body></html>