<html><head><title>March 04: </title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; C/C++ Users Journal--><h4>Listing 4:	<i>Preparing to instantiate the correct persistence implementation class.</i></h4><pre>Controller::Invoke(ICmd* cmd, Vo* vo){    try {        if (vo-&gt;getImp() == Vo::ODBC_SQLServer) {            vo-&gt;setImpLibrary("ReferenceImp_Odbc.dll");            vo-&gt;setImpAppendName("DB_ODBC_SqlServer");        }        if (vo-&gt;getImp() == Vo::ODBC_Oracle) {            vo-&gt;setImpLibrary("ReferenceImp_Odbc.dll");            vo-&gt;setImpAppendName("DB_ODBC_Oracle");        }        else if (vo-&gt;getImp() == Vo::OCCI_Oracle) {            vo-&gt;setImpLibrary("ReferenceImp_Occi.dll");            vo-&gt;setImpAppendName("DB_OCCI");        }        // Now invoke since after vo knows all it needs        cmd-&gt;Execute(vo);    }    catch (exception ex) {        // handle error ...    }    catch (...) {        // handle error    }}</body></html>