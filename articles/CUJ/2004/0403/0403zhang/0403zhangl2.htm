<html><head><title>March 04: </title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; C/C++ Users Journal--><h4>Listing 2:	<i>Major functions of the</i> DocumentContentHandler&lt;Data, Functor&gt; <i>class.</i></h4><pre>//.....template &lt;class Data, class Functor&gt;class DocumentContentHandler : public BaseContentHandler{ protected:    typedef DocumentContentHandler&lt;Data, Functor&gt;  DocHandlerType;    typedef map&lt;XmlString, BaseContentHandler*&gt;    ContentHandlerMap;    typedef ContentHandlerMap::iterator    ContentHandlerIterator;protected:    ContentHandlerMap                         m_AllHandlers;    stack&lt;BaseContentHandler*&gt;                m_ActiveHandlers;    ISAXXMLReader*                            m_pXMLReader;public:    // destructor and other functions not shown    DocumentContentHandler(const XmlString&amp; strDocumentName,                            Functor* pFunctor)         : BaseContentHandler(strDocumentName)     {        m_AllHandlers.insert(          ContentHandlerMap::value_type(strDocumentName,this));          CompositeContentHandler&lt;Data, Functor&gt;*    pHandler =                  new DataHandler(Data::GetClassName(),this,pFunctor);    }    virtual HRESULT STDMETHODCALLTYPE startElement(         /* [in] */ wchar_t __RPC_FAR *pwchNamespaceUri,        /* [in] */ int cchNamespaceUri,        /* [in] */ wchar_t __RPC_FAR *pwchLocalName,        /* [in] */ int cchLocalName,        /* [in] */ wchar_t __RPC_FAR *pwchRawName,        /* [in] */ int cchRawName,        /* [in] */ ISAXAttributes __RPC_FAR *pAttributes)    {        ContentHandlerIterator iter =             m_AllHandlers.find(XmlString(pwchLocalName));        if (iter != m_AllHandlers.end())        {            m_ActiveHandlers.push(iter-&gt;second);            m_pXMLReader-&gt;putContentHandler(iter-&gt;second);        }        return S_OK;    }    virtual HRESULT STDMETHODCALLTYPE endElement(         /* [in] */ wchar_t __RPC_FAR *pwchNamespaceUri,        /* [in] */ int cchNamespaceUri,        /* [in] */ wchar_t __RPC_FAR *pwchLocalName,        /* [in] */ int cchLocalName,        /* [in] */ wchar_t __RPC_FAR *pwchRawName,        /* [in] */ int cchRawName)    {        if(!m_ActiveHandlers.empty())            m_ActiveHandlers.pop();        if(!m_ActiveHandlers.empty())            m_pXMLReader-&gt;putContentHandler(                m_ActiveHandlers.top());        return S_OK;    }};</body></html>