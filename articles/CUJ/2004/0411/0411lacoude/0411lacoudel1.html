<html>
<head>
<title>November, 2004: The .NET Compilation &amp; Execution Model</title>
</head>

<body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000">
<!--Copyright &#169; C/C++ Users Journal-->






<h4>Listing 1</h4>
<pre>
#include "StdAfx.h"
#include "CodeBuilder.h"

using namespace System;
using namespace System::Text;

String* DynamicCompilation::CodeBuilder::TheCode(String* F_x)  // Line 7
{
  StringBuilder* sbCode = new StringBuilder("using System; \r\n");
  sbCode-&gt;Append(S"namespace MyFunctoid \r\n");
  sbCode-&gt;Append(S"{ \r\n");
  sbCode-&gt;Append(S"  public class MyFunc\r\n");
  sbCode-&gt;Append(S"  { \r\n");
  sbCode-&gt;Append(S"    static public double f(double x) \r\n");
  sbCode-&gt;Append(S"    { \r\n");
  sbCode-&gt;Append(S"      double y = ");
  // Add the user's code input                            // Line 18
  sbCode-&gt;Append(F_x);                                        
  sbCode-&gt;Append("; \r\n");
  sbCode-&gt;Append(S"      return y; \r\n");
  sbCode-&gt;Append(S"    } \r\n");
  sbCode-&gt;Append(S"    static private double Abs(double x) 
                                 { return System.Math.Abs(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Acos(double x) 
                                 { return System.Math.Acos(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Asin(double x) 
                                 { return System.Math.Asin(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Atan(double x) 
                                 { return System.Math.Atan(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Atan2(double x, double y) 
                                 { return System.Math.Atan2(x, y); } \r\n");
  sbCode-&gt;Append(S"    static private double Ceiling(double x) 
                                 { return System.Math.Ceiling(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Cos(double x) 
                                 { return System.Math.Cos(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Cosh(double x) 
                                 { return System.Math.Cosh(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Exp(double x) 
                                 { return System.Math.Exp(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Floor(double x) 
                                 { return System.Math.Floor(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Log(double x) 
                                 { return System.Math.Log(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Log10(double x) 
                                 { return System.Math.Log10(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Pow(double x, double y) 
                                 { return System.Math.Pow(x, y); } \r\n");
  sbCode-&gt;Append(S"    static private double Sin(double x) 
                                 { return System.Math.Sin(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Sinh(double x) 
                                 { return System.Math.Sinh(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Sqrt(double x) 
                                 { return System.Math.Sqrt(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Tan(double x) 
                                 { return System.Math.Tan(x); } \r\n");
  sbCode-&gt;Append(S"    static private double Tanh(double x) 
                                 { return System.Math.Tanh(x); } \r\n");
  sbCode-&gt;Append(S"  } \r\n");
  sbCode-&gt;Append(S"} \r\n");
  return sbCode-&gt;ToString();
}
</pre>



</body>
</html>
