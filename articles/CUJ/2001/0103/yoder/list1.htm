<HTML><HEAD>
<TITLE>March 2001/Using Template Functions to Customize Library Behavior/Listing 1</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 1: Providing a user-definable policy via a macro</A></h4>
<pre>
//
//---- begin file library.h ----
//

#ifndef CLASS_POLICY
#  define CLASS_POLICY "default policy"
#endif                  

//
//---- begin file container.h ----
//

#include "library.h"
#include &lt;string&gt;
#include &lt;iostream&gt;


template &lt;class ElementType&gt;
class MyContainer {
public:
   MyContainer(const std::string iName) : instanceName(iName) 
   {}
   // class implementation
   // ...
   
   // performs the policy
   void doPolicy();
   // a service that uses the policy
   void performService() { doPolicy(); }
   
   const std::string instanceName;
};

// elements for example's sake
template&lt;class T&gt;
struct Element1 {
// ...
};

template&lt;class T&gt;
struct Element2 {
// ...
};


template &lt;class ElementType&gt;
void MyContainer&lt;ElementType&gt;::doPolicy() 
{ 
    std::cout &lt;&lt; "Policy is: " &lt;&lt; CLASS_POLICY &lt;&lt; std::endl;
}


//
//---- begin file user.cpp ----
//

#include "container.h"

int main() {
    
   MyContainer&lt;Element1&lt;int&gt; &gt; c("object1");
   c.performService();

   return 0;
}
&#151; End of Listing &#151;</pre></body></html>
