<HTML><HEAD>
<TITLE>January 2001/We Have Mail/Listing 1</TITLE></HEAD>

<BODY BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000">

<h4><A NAME="heading1">Listing 1:	Demonstrates type_name function added to Fernando Cacciola&#146;s variant_t</A></h4>
<pre>
// test0() shows the basic construction and
// use of variant_t with various types.
void test0()
{
  variant_t _int ( 2 ) ;
  variant_t _dbl ( 3.14 ) ;
  variant_t 
  _str ( string ( "This is a string" ) ) ;
  // IMPORTANT NOTE: The above statement 
  // COULD NOT have been 
  // variant_t _str ( "This is a string" );
  // The expression "This is a string" is
  // of type const char *, which is just a
  // pointer. The copy of a pointer is just
  // another pointer of the same value, not
  // a new membory block with a copy of the
  // contents of the original block.
  // The value copied and stored in _str
  // would be the pointer value and not the
  // character array contents.

  cout &lt;&lt; "BEGIN test0" &lt;&lt; endl ;
  #ifdef NO_EXPLICIT_MEMBER_TPL_INSTANTIATION
    cout &lt;&lt; variant_cast&lt;int&gt;(_int) 
         &lt;&lt; " is of type " &lt;&lt; _int.type_name()
         &lt;&lt; endl ;
    cout &lt;&lt; variant_cast&lt;double&gt;(_dbl)
         &lt;&lt; " is of type " &lt;&lt; _dbl.type_name()
         &lt;&lt; endl ;
    cout &lt;&lt; variant_cast&lt;string&gt;(_str)
         &lt;&lt; " is of type " &lt;&lt; _str.type_name()
         &lt;&lt; endl ;
  #else
    cout &lt;&lt; (int)   _int &lt;&lt; " is of type "
         &lt;&lt; _int.type_name() &lt;&lt; endl ;
    cout &lt;&lt; (double)_dbl &lt;&lt; " is of type "
         &lt;&lt; _dbl.type_name() &lt;&lt; endl ;
    cout &lt;&lt; (string)_str &lt;&lt; " is of type "
         &lt;&lt; _str.type_name() &lt;&lt; endl ;
  #endif
  cout &lt;&lt; "END test0"   &lt;&lt; endl &lt;&lt; endl ;

 _dbl = _int;

 cout &lt;&lt; "_dbl = " &lt;&lt; variant_cast&lt;int&gt;(_dbl)
      &lt;&lt; endl;
 cout &lt;&lt; "_int = " &lt;&lt; variant_cast&lt;int&gt;(_dbl)
      &lt;&lt; endl;
}
&#151; End of Listing &#151;</pre></body></html>
