<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 4.0//EN">


<HTML>
<HEAD>
<TITLE>v12, i08: Monitoring Sun Volume Manager</TITLE>
<LINK REL=StyleSheet HREF="../../resource/css/sacdrom.css" TYPE="text/css" TITLE="CSS1">
</HEAD>

<body bgcolor="#ffffff" text="#000000" link="#000000" alink="#669999" vlink="#333366" topmargin=0 leftmargin=0>

<! -- Begin MASTER TABLE -- >
<!center>
<table width=98% cellpadding=0 cellspacing=0 border=0 bgcolor="#ffffff">
  <tr>

<table cellpadding=5 cellspacing=0 border=0>
	<tr>

		<td><span class="navbarLink">Article</span></td>
		<td><span class="navbarLink"><a href="a7_l1.htm">Listing 1</a></span></td>
		<td><a href="../../../../source/SA/2003/aug2003.tar"><b class=codeListing>aug2003.tar</b></a></td>

	</tr>
</table>


</tr>
<tr>
<! -- Begin Content ------ >
    <td valign=top width=527 bgcolor="#ffffff"> 
      <table width=100% cellpadding=15 cellspacing=0 border=0>
<tr>
          <td valign=top> 
            <! -- Insert Content ------ >
            <h1><b><img src="a7.gif" width="200" height="167" align="right">Monitoring 
              Sun Volume Manager</b></h1>
            <p> <i>Andrew Kyle</i>
            <p> Over the years, I've seen a lot of servers that have been 
              built and then eventually neglected. I often find that the servers 
              have been mirrored using "Sun Volume Manager" (or as it 
              was previously known, "Solstice Disksuite") and their 
              configuration has been set and then forgotten. These servers may 
              have been configured for redundancy at one stage, but over time, 
              disks die, configurations change, and people make mistakes. For 
              these reasons, it is imperative for metadevices to be actively monitored 
              to make sure they are doing what they are intended to do.
            <p> Here I will provide a script for monitoring volume manager setup 
              and briefly describe how it works. Metadevice monitoring should 
              go hand in hand with the general monitoring of the server that includes 
              monitoring logs, filesystems, and performance.
            <p> The script provided in this article (Listing 1) is a simple but 
              effective way to monitor the volume manager setup. It basically 
              looks for metadevices that are not in the "okay" state 
              or hot spares that are not in the "available" state. It 
              also does one other handy check. It looks for devices that have 
              been configured to be mirrors and have only one sub-mirror. This 
              is an excellent way to tell whether you have forgotten to attach 
              your mirrors.
            <p> This script does not require any special privileges, so long as 
              it can run metastat (which has default permissions of 755). This 
              means the script can be executed by any user's cron for automation. 
              I suggest running the script as often you feel necessary for effective 
              monitoring and to allow sufficient time to react to incidents that 
              happen. I run it every 10 minutes from a monitoring collection script 
              that filters out any messages that are the same and that have already 
              been sent that day. In doing so, I avoid having my email box cluttered 
              with duplicate messages.
            <p> As a further note, you must ensure that sendmail (or equivalent 
              MTA) is running on your server. Sendmail should always be running 
              in queue mode (<b>-q</b>), and only running in listening mode (<b>-bd</b>) 
              if absolutely necessary. Mail can have network connection problems, 
              or not be sent due to server load, etc. and will just be queued 
              on the server. However, there is no point in queuing the mail if 
              you aren't going to receive it within an appropriate time. 
              Running the sendmail daemon in queue mode will allow the queue to 
              be reprocessed at a configured amount of time later and sent out 
              as soon as possible.
            <p> <b>Conclusion</b>
            <p> Monitoring is a major part of a systems administrators job. It 
              is important that all aspects of a server that affect it's 
              performance, reliability and availabilty are monitored. This simple 
              script will effectively catch any problems with the server's metadevices 
              so prompt action can be taken to maintain redundancy and reliability.
            <p> <i>Andrew received a Bachelor of Technology in Computer System 
              Engineering from Massey University, NZ in 1994. Since then, he's 
              done UNIX systems administration in Brisbane for Queensland Police 
              and CITEC. He has been concentrating on Solaris during the past 
              5 years by contracting in London, mainly for a Securities Bank and 
              now working for CSC in Sydney, Australia.</i>
          </table></table>&nbsp;

<! -- End Content ------ >

<!/center>
<! -- End MASTER TABLE -- >

</body>



<! -- Begin Content ------ >
</html>
