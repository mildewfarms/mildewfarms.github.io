<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 4.0//EN">


<HTML>
<HEAD>
<TITLE>v12, i09: Figure 2 Random TCP source ports (CONFIG_GRKERNSEC_RANDSRC)</TITLE>
<LINK REL=StyleSheet HREF="../../resource/css/sacdrom.css" TYPE="text/css" TITLE="CSS1">
</HEAD>

<body bgcolor="#ffffff" text="#000000" link="#000000" alink="#669999" vlink="#333366" topmargin=0 leftmargin=0>

<! -- Begin MASTER TABLE -- >
<!center>
<table width=98% cellpadding=0 cellspacing=0 border=0 bgcolor="#ffffff">
  <tr>

<table cellpadding=5 cellspacing=0 border=0>
	<tr>

		<td><span class="navbarLink"><a href="a7.htm">Article</a></span></td>
		<td><span class="navbarLink"><a href="a7_f1.htm">Figure 1</a></span></td>
		<td><span class="navbarLink">Figure 2</span></td>
		<td><span class="navbarLink"><a href="a7_f3.htm">Figure 3</a></span></td>
		<td><span class="navbarLink"><a href="a7_f4.htm">Figure 4</a></span></td>
		<td><a href="../../../../source/SA/2003/sep2003.tar"><b class=codeListing>sep2003.tar</b></a></td>

	</tr>
</table>


</tr>
<tr>
<! -- Begin Content ------ >
    <td valign=top width=527 bgcolor="#ffffff"> 
      <table width=100% cellpadding=15 cellspacing=0 border=0>
<tr>
          <td valign=top> 
            <! -- Insert Content ------ >
            <h1><b>Figure 2 </b><i>Random TCP source ports (CONFIG_GRKERNSEC_RANDSRC)</i></h1>
            <p> 
            <pre>[root@grsecurity root]# tcpdump -i lo dst port 5000 -w /tmp/output -c 2 &amp;
[1] 14764
tcpdump: listening on lo
[root@grsecurity root]# telnet localhost 5000
Trying 127.0.0.1...
telnet: connect to address 127.0.0.1: Connection refused
[root@grsecurity root]# telnet localhost 5000
Trying 127.0.0.1...
4 packets received by filter
0 packets dropped by kernel
telnet: connect to address 127.0.0.1: Connection refused
[1]+  Done                    tcpdump -i lo dst port 5000 -w /tmp/output
-c 2
[root@grsecurity root]# tcpdump -r /tmp/output
14:24:36.567312 localhost.50690 &gt; localhost.5000: S
4010487236:4010487236(0) win 32767 &lt;mss 16396,sackOK,timestamp 22457739
0,nop,wscale 0&gt; (DF) [tos 0x10]
14:24:37.529007 localhost.33211 &gt; localhost.5000: S
3051702410:3051702410(0) win 32767 &lt;mss 16396,sackOK,timestamp 22457836
0,nop,wscale 0&gt; (DF) [tos 0x10]

---

[root@no-grsecurity root]# tcpdump -i lo dst port 5000 -w /tmp/output -c 2 &amp;
[1] 26922
tcpdump: listening on lo
[root@d=no-grsecurity root]# telnet localhost 5000
Trying 127.0.0.1...
telnet: connect to address 127.0.0.1: Connection refused
[root@no-grsecurity root]# telnet localhost 5000
Trying 127.0.0.1...
4 packets received by filter
0 packets dropped by kernel
telnet: connect to address 127.0.0.1: Connection refused
[1]+  Done                    tcpdump -i lo dst port 5000 -w /tmp/output
-c 2
[root@no-grsecurity root]# tcpdump -r /tmp/output
14:26:59.225768 localhost.localdomain.48533 &gt;
localhost.localdomain.5000: S 3264532978:3264532978(0) win 32767 &lt;mss
16396,sackOK,timestamp 95383280 0,nop,wscale 0&gt; (DF) [tos 0x10]
14:26:59.922787 localhost.localdomain.48534 &gt;
localhost.localdomain.5000: S 3264231394:3264231394(0) win 32767 &lt;mss
16396,sackOK,timestamp 95383350 0,nop,wscale 0&gt; (DF) [tos 0x10]</pre>
        </table></table>&nbsp;

<! -- End Content ------ >

<!/center>
<! -- End MASTER TABLE -- >

</body>



<! -- Begin Content ------ >
</html>
