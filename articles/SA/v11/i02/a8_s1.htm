<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 4.0//EN">


<HTML>
<HEAD>
<TITLE>v11, i02: About Listing 1</TITLE>
<LINK REL=StyleSheet HREF="../../resource/css/sacdrom.css" TYPE="text/css" TITLE="CSS1">
</HEAD>

<body bgcolor="#ffffff" text="#000000" link="#000000" alink="#669999" vlink="#333366" topmargin=0 leftmargin=0>

<! -- Begin MASTER TABLE -- >
<!center>
<table width=98% cellpadding=0 cellspacing=0 border=0 bgcolor="#ffffff">
  <tr>

<table cellpadding=5 cellspacing=0 border=0>
	<tr>

		<td><span class="navbarLink"><a href="a8.htm">Article</a></span></td>
		<td><span class="navbarLink"><a href="a8_l1.htm">Listing 1</a></span></td>
		<td><span class="navbarLink"><a href="a8_l2.htm">Listing 2</a></span></td>
		<td><span class="navbarLink"><a href="a8_l3.htm">Listing 3</a></span></td>
		<td><span class="navbarLink">Sidebar 1</span></td>
	</tr>
	<tr>
		<td><span class="navbarLink"><a href="a8_s2.htm">Sidebar 2</a></span></td>
		<td><a href="../../../../source/SA/2002/feb2002.tar"><b class=codeListing></b></a></td>

	</tr>
</table>


</tr>
<tr>
<! -- Begin Content ------ >
    <td valign=top width=527 bgcolor="#ffffff"> 
      <table width=100% cellpadding=15 cellspacing=0 border=0>
<tr>
          <td valign=top> 
            <! -- Insert Content ------ >
            <H1>About Listing 1</h1>
            <p> 1. Use <b>fork()</b> to create an exact copy of the parent (line 
              14) to disconnect from the controlling terminal and be sure it's 
              not executing as a process group leader.
            <p> 2. In the child process, use <b>setsid()</b> to create a new session 
              (line 40), which automatically makes the child process the leader 
              of the new session.
            <p> 3. Close STDIN, STDOUT, and STDERR to be sure the daemon won't 
              output anything to the screen or try to read anything from the console 
              (lines 49, 50, and 51). Instead, the program will output information 
              to some files.
            <p> 4. Change the working directory to <b>/</b> (line 58) to prevent 
              blocking any device that might need to be unmounted. For example, 
              if you have <b>/home</b> on a separate partition and your current 
              directory is <b>/home/myself</b> when you start the program, you 
              won't be able to unmount <b>/home</b> if you skip the <b>chdir("/")</b>.
            <p> 5. Start the infinite loop that will run <b>do_quota_stuff()</b> 
              every two seconds (lines 64 through 74).
            <p> 
            <p> We now have a full-featured daemon process that repeats every 
              two seconds until you explicitly tell it to stop by killing it. 
              However, the real functionality is implemented in the <b>do_quota_stuff()</b> 
              function, shown in Listing 2.
          </table></table>&nbsp;

<! -- End Content ------ >

<!/center>
<! -- End MASTER TABLE -- >

</body>



<! -- Begin Content ------ >
</html>
