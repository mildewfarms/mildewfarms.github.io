<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 4.0//EN">


<HTML>
<HEAD>
<TITLE><title>v05, i06: Listing 3: Examples of firewall rules</title></TITLE>
<LINK REL=StyleSheet HREF="../../resource/css/sacdrom.css" TYPE="text/css" TITLE="CSS1">
</HEAD>

<body bgcolor="#ffffff" text="#000000" link="#990000" alink="#669999" vlink="#333366" topmargin=0 leftmargin=0>

<! -- Begin MASTER TABLE -- >
<!center><table width=600 cellpadding=0 cellspacing=0 border=0 bgcolor="#ffffff">

<tr>

<table cellpadding=5 cellspacing=0 border=0>
	<tr>

		<td><span class=navbarLink><a href="a2.htm">Article</a></span></td>
		<td><span class=navbarLink><a href="a2_f1.htm">Figure 1</a></span></td>
		<td><span class=navbarLink><a href="a2_f2.htm">Figure 2</a></span></td>
		<td><span class=navbarLink><a href="a2_f3.htm">Figure 3</a></span></td>
		<td><span class=navbarLink><a href="a2_l1.htm">Listing 1</a></span></td>
	</tr>
	<tr>
		<td><span class=navbarLink><a href="a2_l2.htm">Listing 2</a></span></td>
		<td><span class=navbarLink>Listing 3</span></td>
		<td><span class=navbarLink><a href="a2_l4.htm">Listing 4</a></span></td>
		<td><span class=navbarLink><a href="a2_l5.htm">Listing 5</a></span></td>
		<td><span class=navbarLink><a href="a2_l6.htm">Listing 6</a></span></td>
	</tr>
	<tr>
		<td><span class=navbarLink><a href="a2_l7.htm">Listing 7</a></span></td>
		<td><span class=navbarLink><a href="a2_l8.htm">Listing 8</a></span></td>
		<td><span class=navbarLink><a href="a2_l9.htm">Listing 9</a></span></td>
		<td><span class=navbarLink><a href="a2_l10.htm">Listing 10</a></span></td>
		<td><span class=navbarLink><a href="a2_l11.htm">Listing 11</a></span></td>
	</tr>
	<tr>
		<td><span class=navbarLink><a href="a2_s1.htm">Sidebar 1</a></span></td>
		<td><span class=navbarLink><a href="a2_s2.htm">Sidebar 2</a></span></td>
		<td><span class=navbarLink><a href="a2_s3.htm">Sidebar 3</a></span></td>
		<td><span class=navbarLink><a href="a2_s4.htm">Sidebar 4</a></span></td>
		<td><span class=navbarLink><a href="a2_s5.htm">Sidebar 5</a></span></td>
		<td><span class=navbarLink><a href="a2_s6.htm">Sidebar 6</a></span></td>
		<td><span class=navbarLink><a href="a2_s7.htm">Sidebar 7</a></span></td>
		<td><a href="../../../../source/SA/1996/jun96.tar"><b class=codeListing>jun96.tar</b></a></td>

	</tr>
</table>


</tr>
<tr>
<! -- Begin Content ------ >
<td valign=top width=440 bgcolor="#ffffff">
<table width=100% cellpadding=15 cellspacing=0 border=0>
<tr><td valign=top>
<H1>Listing 3: Examples of firewall rules</H1><p>
<PRE>
# Add output rule for local -&gt; Internet
ipfwadm -O -a accept -P tcp -S 194.109.13.150 -D 0.0.0.0/0

This rule defines an output rule for the Internet interface. It states
that a packet for any destination on the Internet  is allowed out. This
rule applies only to packets for the TCP protocol.

# Add input rules for cli# Add output rule for local -&gt; Internet
ipfwadm -O -a accept -P tcp -S 194.109.13.150 -D 0.0.0.0/0

This rule defines an output rule for the Internet interface. It states
that a packet for any destination on the Internet  is allowed out. This
rule applies only to packets for the TCP protocol.

# Add input rules for clients -&gt; Internet (will masquerade)
ipfwadm -I -a accept -P tcp -V 193.78.174.33 -S 193.78.174.34 -D 0.0.0.0/0
ipfwadm -I -a accept -P tcp -V 193.78.174.33 -S 193.78.174.35 -D 0.0.0.0/0

This rule describes packets sent by the hosts on the local net to
destinations on the Internet. These packets are  going to be masqueraded
by the forwarding rules. As you can see, these packets must be received
on the trusted  interface 193.78.174.33 (-V option).

The final example shows you a masquerading rule.

# Add forwarding rules for clients
ipfwadm -F -a masquerade -P tcp -S 193.78.174.34 -D 0.0.0.0/0
ipfwadm -F -a masquerade -P tcp -S 193.78.174.35 -D 0.0.0.0/0

As you can see, the policy here is masquerade, so these packets will be masqueraded.

You can find the complete list of firewall rules in the listing at the
end of this article.
</pre><p>
<p>


<P>
<br>&nbsp;<br>
</table></center></td>
<! -- End Content ------ >

</table><!/center>
<! -- End MASTER TABLE -- >

</body></html>
