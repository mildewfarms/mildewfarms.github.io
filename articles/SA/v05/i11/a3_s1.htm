<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 4.0//EN">


<HTML>
<HEAD>
<TITLE>v05, i11:  Sidebar: Protected Password Authentication Database File Format</TITLE>
<LINK REL=StyleSheet HREF="../../resource/css/sacdrom.css" TYPE="text/css" TITLE="CSS1">
</HEAD>

<body bgcolor="#ffffff" text="#000000" link="#990000" alink="#669999" vlink="#333366" topmargin=0 leftmargin=0>

<! -- Begin MASTER TABLE -- >
<!center><table width=600 cellpadding=0 cellspacing=0 border=0 bgcolor="#ffffff">

<tr>

<table cellpadding=5 cellspacing=0 border=0>
	<tr>

		<td><span class=navbarLink><a href="a3.htm">Article</a></span></td>
		<td><span class=navbarLink><a href="a3_l1.htm">Listing 1</a></span></td>
		<td><span class=navbarLink>Sidebar 1</span></td>
		<td><span class=navbarLink><a href="a3_s2.htm">Sidebar 2</a></span></td>
		<td><a href="../../../../source/SA/1996/nov96.tar"><b class=codeListing>nov96.tar</b></a></td>

	</tr>
</table>


</tr>
<tr>
<! -- Begin Content ------ >
<td valign=top width=440 bgcolor="#ffffff">
<table width=100% cellpadding=15 cellspacing=0 border=0>
<tr><td valign=top>




<H1>Sidebar: Protected Password Authentication Database File Format</H1><p>
<P>
An authentication file is maintained for each user
account on an
Enhanced Security-enabled system. These files are located
under
/tcb/files/auth, which is accessible only to the superuser.
The
encrypted password string, among other things, is stored
in this file.
Options specified in an individual account Protected
Password file
override any Global settings specified in the System
Default file. The
following is the Protected Password file for my account
on a system
running Enhanced Security:<P>
<PRE>
mcheek:u_name=mcheek:u_id#247:u_oldcrypt#0:\
:u_pwd=1o2A5Adx3oXXm:\
:u_succhg#828919424:u_unsucchg#829276329:\
:u_suclog#839193127:u_suctty=ttyp1:\
:u_unsuclog#838691522:u_unsuctty=ttyp1:u_lock@:\
:chkent:</pre><p>
<p>
The format for this file is identical to the format
for the System
Default file.<P>

The example options have the following meaning:<P>

mcheek: This first option is simply the header that
specifies the name
of file for this security database and is required.<P>

u_name=mcheek: This is the username for the account
and must match the
username in a corresponding /etc/password entry.<P>

u_id#247: This is the user ID for the account and must
match the user ID
in a corresponding /etc/password entry.<P>

u_oldcrypt#0: This is the algorithm number used to encrypt
the current
password.<P>

u_pwd=1o2A5Adx3oXXm: This is the encrypted password
string for the
account. (This is not an actual password.)<P>

u_succhg#828919424: This option specifies the time of
the last
successful password change. The time is specified as
the number of
seconds since the Epoch, 00:00:00 GMT 1 Jan 1970. Obviously,
this time
value is not immediately useful, and in fact, this field
should only be
set by programs (such as passwd(1)) that can be used
to change the
account password.<P>

u_unsucchg#829276329: This option specifies the time
of the last
unsuccessful password change. This field should not
be manually edited.<P>

u_suclog#839193127: This option specifies the time of
the last
successful login. This field should not be manually
edited.<P>

u_suctty=ttyp1: This is the name of the terminal associated
with the
last successful login to the account.<P>

u_unsuclog#838691522: This option specifies the time
of the last
unsuccessful login. This field should not be manually
edited.<P>

u_unsuctty=ttyp1: This is the name of the terminal associated
with the
last unsuccessful login to the account.<P>

u_lock@: This Boolean option is used to administratively
lock an
account. A u_lock entry indicates that the account is
locked; a u_lock@
entry indicates that it is not.<P>

For additional information, see the manpage for prpasswd(4).<P>




<P>
<br>&nbsp;<br>
</table></center></td>
<! -- End Content ------ >

</table><!/center>
<! -- End MASTER TABLE -- >

</body></html>
