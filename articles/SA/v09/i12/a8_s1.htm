<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 4.0//EN">


<HTML>
<HEAD>
<TITLE>v09, i12: Sidebar 1</TITLE>
<LINK REL=StyleSheet HREF="../../resource/css/sacdrom.css" TYPE="text/css" TITLE="CSS1">
</HEAD>

<body bgcolor="#ffffff" text="#000000" link="#990000" alink="#669999" vlink="#333366" topmargin=0 leftmargin=0>

<! -- Begin MASTER TABLE -- >
<!center><table width=600 cellpadding=0 cellspacing=0 border=0 bgcolor="#ffffff">

<tr>

<table cellpadding=5 cellspacing=0 border=0>
	<tr>

		<td><span class=navbarLink><a href="a8.htm">Article</a></span></td>
		<td><span class=navbarLink>Sidebar 1</span></td>
		<td><a href="../../../../source/SA/2000/dec2000.tar"><b class=codeListing>dec2000.tar</b></a></td>

	</tr>
</table>


</tr>
<tr>
<! -- Begin Content ------ >
<td valign=top width=440 bgcolor="#ffffff">
<table width=100% cellpadding=15 cellspacing=0 border=0>
<tr><td valign=top>
<! -- Insert Content ------ >



<H1>Sidebar 1:  fcheck_file_support</H1><p>
Although the documentation states that FCheck supports the monitoring of individual files, this statement was left over from earlier documentation. This is clarified in the author's FAQ in the README file. The author, Michael Gumienny, mentions in the FAQ that the user can simulate single file support basically by defining the directory and excluding everything else. This is what the few lines of code below in the <B>fcheck_file_support </B>does. After placing the file in an appropriate place, such as <B>/usr/local/bin/</B> and setting the execute bit, you can run the program with two parameters: the directory, and the file that you wish to monitor. The script will then print out a list of Exclusion statements that you can either redirect with append mode (<B>&gt;&gt;</B>) to the config file or paste into the file. Be sure that you also have the <B>Directory = parameter</B> before the <B>Exclusion</B> entries as well.<P>
Although this script does the trick, it is not as granular as a complete integration could be. Additionally, any new files created in the directory will also set of the IDS...not a bad thing, but not the complete control that many of us would like to have. However, as I mentioned in the column, FCheck is still a very good thing to have in your toolbox.<P>
<pre>
#!/bin/bash
# fcheck_file_support

if echo $1 | grep -v \/$ &gt;/dev/null
then
        dir="$1/"
else
        dir="$1"
fi

for i in &#145;ls $1&#145;
do
        echo "Exclusion      = $dir$i" | grep -v "/$2"
done
</pre>



<! -- Begin Content ------ >
<br>&nbsp;<br>
</table></center></td>
<! -- End Content ------ >

</table><!/center>
<! -- End MASTER TABLE -- >

</body></html>
