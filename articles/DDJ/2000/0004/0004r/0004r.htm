<html><head><title>Apr00: Dr. Ecco's Omniheurist Corner</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; Dr. Dobb's Journal--><h1>Blood</h1><p><i>Dr. Dobb's Journal</i> April 2000</p><h3>By Dennis E. Shasha</h3><I>Dennis, a professor of computer science at NYU, is the author of The Puzzling Adventures of Dr. Ecco (Dover, 1998) and Pattern Discovery in Biomolecular Data: Tools, Techniques, and Applications (Oxford University Press, 1999), among others. He can be contacted at DrEcco@ddj.com.</I><hr><p>He wore a sports jacket and a tie, but a stethoscope dangled from his neck. Dr. Max Jacobs looked us over for a few seconds each. </p><p>"I hope you aren't squeamish, young lady," he said to 11 year-old Liane. "We're going to talk about blood."</p><DDJADVERTISEMENT INLINE><p>"Human or newt?" Liane asked with a grin.</p><p>Jacobs smiled, "A quick wit. We'll need that for the problem I'm going to pose to you, Dr. Ecco. </p><p>"As you may know, Hepatitis C is a horribly debilitating illness that can be passed by blood transfusion. The test for the presence of Hepatitis C is called the Elisa test. It isn't accurate enough, giving us both false positives (good blood is thought to be bad) and false negatives (bad blood is thought to be good). There is an expensive but very precise technique based on the Polymerase Chain Reaction (PCR). This technique is so precise that if we take a drop of blood from 50,000 different pints and as few as one pint has Hepatitis C, we will detect it.</p><p>"Our center receives 100,000 pints per day. Very close to 1 percent of those pints has the disease. We would like to figure out which pints have Hepatitis C by using no more than 20,000 tests. Each test takes a day, however, and we want to decide the fate of each pint in two days or less. Can you help us?"</p><p>"How accurate do we have to be?" asked Liane. "I mean if you don't care whether you throw out some good blood with the bad, then we need no tests at all -- just throw out the whole lot."</p><p>"You have a future in health administration," Jacobs answered with a grin. "To start with, please assume that you can't throw out more than two good pints with every bad pint."</p><p>"Let's first try the case where each pint can be tested for only one day before its fate must be decided," Ecco suggested.</p><p><i>Reader: Before reading on, see if you can find a method that results in under 35,000 tests and doesn't entail throwing out more than 2000 pints of good blood, assuming there are 1000 pints of bad blood. The fate of each pint must be decided in one day.</i></p><p>"Good suggestion, uncle," said Liane to Ecco. "Well, since there are 1000 bad pints, and we allow 2000 false positives, we divide the pints into 33,333 groups of three and one group of one. We test all the pints in each group together. 1000 groups of three will have a bad pint. For each such group, we throw out all the pints."</p><p><i>Reader: In the situation in which two days are allowed for testing and there are 1000 bad pints out of 100,000 and 2000 good pints may be thrown out, Liane was able to do the job with under 12,000 tests. How well can you do?</i></p><p>"What if no errors are permitted?" </p><p><i>Reader: Liane was able to handle the no-error case in 20,000 tests.</i></p><p>"So, we either throw away perfectly good blood, or we need that many tests," said Dr. Jacobs sadly. "Suppose our pretest screening improved a lot and we could ensure that no more than one pint had Hepatitis C. What is the smallest number of tests you could do with one day of testing, assuming you don't want to waste any good blood?"</p><p><i>Reader: Liane was able to do this with just 17 tests, but each test requires samples from many pints.</i></p><p>"Maybe one bad pint is unreasonable. What if there could be a small number, say 10. You still don't want to waste any good blood."</p><p><i>Reader: Liane had no particularly good method for this that was guaranteed to give an answer in one day. Even for two days, her best answer required 1900 tests in the worst case. Can you do better?</i></p><p>Jacobs had taken notes in a medically illegible scrawl. He even wrote down Liane's last solution. "You have a brilliant niece Ecco. My compliments," he said. He folded his piece of paper into his jacket pocket shook hands with us and left looking very satisfied. Ecco was not.</p><p>"Liane, think," he demanded of his niece. "The gap between 17 and 1900 is huge, all for a handful of pints that could be bad. Surely you can close the gap. Suppose I give you as many days as you want."</p><p><i>For the case of two bad pints, Liane had a solution requiring under 40 tests, but nearly 20 days.</i></p><p>I never heard either of them speak more of the generalization of this problem.</p><p><i>Reader: Do you have any ideas regarding the problem "You have a handful (10 or fewer) of bad pints out of 100,000. You have as many days as you please. How do you do the grouping and testing?"</i></p><h3>Last Month's Solution</h3><p>The solution to the first question concerning the game "Simple" is that player X can force a win in the original game in about eight moves. Here is how. Without loss of generality, X can force the following situation (or something symmetric):</p><blockquote><p>XO</p><p>X</p></blockquote><p>Now, O has two choices (because any other would lead to three Xs in a line and make it impossible for O to stop the result):</p><blockquote><p>1.</p><p>O</p><p>XO</p><p>X</p><p>2.</p><p>XO</p><p>X</p><p>O</p></blockquote><p>Let's follow Case 1 first. Player X forces player O by threatening a win:</p><blockquote><p>O</p><p>XO</p><p>X</p><p>X</p></blockquote><p>Player O stops the certain win:</p><blockquote><p>O</p><p>XO</p><p>XX</p><p>O</p></blockquote><p>Now player X plays under the first O:</p><blockquote><p>O</p><p>XO</p><p>XX</p><p>X</p><p>O</p></blockquote><p>Now, O must stop the two Xs and has two choices:</p><p>1.1</p><blockquote><p>O</p><p>XO</p><p>XXO</p><p>X</p><p>O</p></blockquote><p>1.2</p><blockquote><p> O</p><p> XO</p><p>OXX</p><p> X</p><p> O</p></blockquote><p>From 1.1, we get to:</p><blockquote><p> O</p><p> XO</p><p>XXXO</p><p> X</p><p> O</p></blockquote><p>followed/forced by:</p><blockquote><p>  O</p><p>  XO</p><p>OXXXO</p><p>  X</p><p>  O</p></blockquote><p>and this is followed by:</p><blockquote><p>  O</p><p>  XO</p><p>OXXXO</p><p> XX</p><p>  O</p></blockquote><p>which leads to two forced wins (a forced win is three Xs in a row without Os) So, this finishes Case 1.1.</p><p>From 1.2, player X can play a forcing move:</p><blockquote><p> O</p><p> XO</p><p>OXXX</p><p> X</p><p> O</p></blockquote><p>So, player O responds with:</p><blockquote><p> O</p><p> XO</p><p>OXXXO</p><p> X</p></blockquote><p>Now, player X does:</p><blockquote><p> O</p><p> XO</p><p>OXXXO</p><p> X X</p><p> O</p></blockquote><p>and can force a win.</p><p>In Case 2, Player X plays a forcing move:</p><blockquote><p>X</p><p>XO</p><p>X</p><p>O</p></blockquote><p>So, player O must respond:</p><blockquote><p>O</p><p>X</p><p>XO</p><p>X</p><p>O</p></blockquote><p>Now, player X does:</p><blockquote><p>O</p><p>X</p><p>XO</p><p>XX</p><p>O</p></blockquote><p>So, player O must respond with either:</p><p>2.1</p><blockquote><p>O</p><p>X</p><p>XO</p><p>XXO</p><p>O</p></blockquote><p>or</p><p>2.2</p><blockquote><p> O</p><p> X</p><p> XO</p><p>OXX</p><p> O</p></blockquote><p>In Case 2.1, player X plays a forcing move and player O responds:</p><blockquote><p>  O</p><p>  X</p><p>  XO</p><p>OXXXO</p><p>  O</p></blockquote><p>Then player X plays:</p><blockquote><p>  O</p><p> XX</p><p>  XO</p><p>OXXXO</p><p>  O</p></blockquote><p>and guarantees a win. This takes care of Case 2.1.</p><p>In Case 2.2, player X plays a forcing move and player O responds:</p><blockquote><p> O</p><p> X</p><p> XO</p><p>OXXXO</p><p> O</p></blockquote><p>Now, player X plays the following clever move (unconnected to any other node):</p><blockquote><p> O</p><p> X X</p><p> XO</p><p>OXXXO</p><p> O</p></blockquote><p>This ensures a win by X. This takes care of Case 2.2.</p><h3>Reader Notes on the  "Stars and Starlets Puzzle"</h3><p>Several readers improved on Dr. Ecco's solution to the "Stars and Starlets Puzzle" (<i>DDJ</i>, January 2000). The best solutions, starting with the suggestion of Chris Young, had the following flavor:</p><blockquote><p>Scenes</p><p>Day 1<br>1 Hacket<br>6 Thompson McDougal Anderson Scolaro Spring<br>14 Anderson Scolaro<br>18 Scolaro McDougal Hacket Thompson<br></p><p>Day 2<br>3 McDougal Scolaro Mercer Brown<br>9 Casta McDougal Mercer Scolaro Thompson<br>10 Casta McDougal Scolaro Patt<br>16 Scolaro McDougal Casta Mercer<br>17 Scolaro Patt Brown<br></p><p>Day 3<br>2 Patt Hacket Brown Murphy<br>5 Mercer Anderson Patt McDougal Spring<br>11 Patt<br>12 Hacket Thompson McDougal Murphy Brown<br>15 Thompson Murphy McDougal Patt<br></p><p>Day 4<br>4 Casta Mercer<br>7 Casta Patt<br>8 Mercer Murphy<br>13 Hacket Murphy Casta Patt<br>19 Casta<br></p></blockquote><p>This gives a total of $3,341,440 for actors' fees (a substantial savings over the original cost of $4,975,360). Other readers with similarly excellent solutions (that is, that gave the same actor fee total) included: Thomas Cloutier, Tomas G. Rokicki, Jason Strickland, Onno Waalewijn, Christian Grigis, Paolo Friedli, Tom Dinger, Charles Taylor, Alan Dragoo, Geoffrey Probert, Patrick R. Schonfeld, Frank Adrian, Mark Whitaker, Jacques Belzile, Fernando H. Kato, David Berson, Mathew Davies, John A. Trono, Philip Staite, Scott Williams, Carl Smotricz, Francis C. Swasey, Larry Holding, Herb Halvorson, Kurt Jones, Malcolm Kay, Brenton Hoffski, and Terje Mathisen.</p><p>Several clever readers improved on Dr. Ecco's solution but left some unnecessary actor fees relative to the Young et al. solutions: Jon Beal, Greg Smith, Jeff Hafner, Nick Knight, Craig Stevenson, Philip Staite, Earl Paddon, Charles E. Killian II, Pike Enz, Jason Strickland, Paul Gerken, Sy Wong, and Geoffrey Probert.</p><p><b>DDJ</b></p></body></html>