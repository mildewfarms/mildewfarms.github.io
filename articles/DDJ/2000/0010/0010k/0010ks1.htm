<html><head><title>Oct00: The CVS Branching Process In Detail</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; Dr. Dobb's Journal--><h2>The CVS Branching Process In Detail</h2><p>Here are the exact operations to do when working on a branch. For this example, assume that the module you are working in is called "myproj" and you are making a branch called "BRANCH_B1."</p><p></p><DDJADVERTISEMENT INLINE><p>Step 1. Create your branch and tag the HEAD where it was made. Then check out a copy of your module that is on the branch. </p><blockquote><p>CVS Command Line: </p><p>   cvs rtag TAG_CREATE_B1 myproj</p><p>WinCVS Operation:</p><p>   Create | Create a tag by module</p><p>       New Tag Name: TAG_CREATE_B1</p><p>       Module to Tag: myproj</p><p>CVS Command Line:</p><p>    cvs rtag -b -r TAG_CREATE_B1 BRANCH_B1 myproj</p><p>WinCVS Operation:</p><p>   Create | Create a branch by module:</p><p>      New Branch Name: BRANCH_B1</p><p>      Module to Fork: myproj</p><p>      Fork from this rev./tag: TAG_CREATE_B1</p><p>CVS Command Line:</p><p>    cvs co -r BRANCH_B1 myproj</p><p>    </p><p>WinCVS Operation:</p><p>   Create | Checkout module...</p><p>      Checkout settings: Enter the module name and path on the 						server: myproj</p><p>      Checkout options: By revision/tag/branch: BRANCH_B1</p></blockquote><p>Step 2. Merge changes in the HEAD the first time. First tag the HEAD to establish a merge point. Then do the merge.</p><blockquote><p>CVS Command Line:</p><p>    cvs rtag TAG_HEAD_MERGE_TO_B1 myproj</p><p>    </p><p>WinCVS Operation:</p><p>   Create | Create a tag by module</p><p>      New Tag Name: TAG_HEAD_MERGE_TO_B1</p><p>      Module to Tag: myproj</p><p>CVS Command Line:</p><p>    cd to myproj that is checked-out on BRANCH_B1</p><p>    cvs update -jHEAD</p><p>WinCVS Operation:</p><p>   Select myproj that is checked-out on BRANCH_B1</p><p>         Modify | Update selection</p><p>         Merge Options: Only this rev./tag: HEAD</p></blockquote><p>Step 3. Correct conflicts and commit. After the commit, tag the branch. Concurrency Issue: This step assumes that no one is making changes on the branch from the time of that update in the past step to the "cvs rtag" operation in this one. If that cannot be assured, tag the working area instead of the repository (that is, use cvs tag instead of cvs rtag).</p><blockquote><p>CVS Command Line:</p><p>    cvs rtag -r BRANCH_B1 TAG_B1_MERGE_FROM_HEAD myproj</p><p>WinCVS Operation:</p><p>   Create | Create a tag by module</p><p>      New Tag Name: TAG_B1_MERGE_FROM_HEAD</p><p>      Module to Tag: myproj</p><p>      Tag revision/tag/branch: BRANCH_B1</p></blockquote><p>Step 4. Continue working on the branch until you want to merge in changes from the HEAD again.</p><p>Step 5. Merge changes in the HEAD that occurred between your last merge and now. This is the important step to understand. Merge from the old tag on the HEAD to the present.</p><blockquote><p>CVS Command Line:</p><p>    cvs update -jTAG_HEAD_MERGE_TO_B1 -jHEAD</p><p>WinCVS Operation:</p><p>   Modify | Update selection</p><p>   Merge Options: </p><p>       Only this rev./tag: TAG_HEAD_MERGE_TO_B1</p><p>       Plus with this rev./tag: HEAD</p></blockquote><p>Move the tag. The same concurrency issue from Step 3 applies here as well. </p><blockquote><p>CVS Command Line:</p><p>    cvs rtag -F TAG_HEAD_MERGE_TO_B1 myproj</p><p>WinCVS Operation:</p><p>   Create | Create a tag by module</p><p>      New Tag Name: TAG_HEAD_MERGE_TO_B1</p><p>      Module to Tag: myproj</p><p>      Check: Overwrite existing tags with the same name</p></blockquote><p>Fix conflicts and commit.</p><p>Update the tag on the branch: </p><blockquote><p>CVS Command Line:</p><p>    cvs rtag -F -r BRANCH_B1 TAG_B1_MERGE_FROM_HEAD 						myproj</p><p>WinCVS Operation:</p><p>   Create | Create a tag by module</p><p>      New Tag Name: TAG_B1_MERGE_FROM_HEAD</p><p>      Module to Tag: myproj</p><p>      Tag revision/tag/branch: BRANCH_B1</p><p>      Check: Overwrite existing tags with the same name</p></blockquote><p>Step 6. If more work is to be done on the branch, go to Step 4. Otherwise go to the next step.</p><p>Step 7. When done with the branch, merge changes from the branch to the HEAD.</p><blockquote><p>CVS Command Line:</p><p>    cd to myproj that is checked-out on HEAD (not BRANCH_B1)</p><p>    cvs update -jBRANCH_B1</p><p>    </p><p>WinCVS Operation:</p><p>   Select myproj that is checked-out on HEAD (not BRANCH_B1)</p><p>        Modify | Update selection</p><p>        Merge Options: Only this rev./tag: BRANCH_B1</p></blockquote><p>Step 8. Fix conflicts. You will likely see a lot of conflicts here that you dealt with already on the side branch. The second choice conflict is the one that came from the branch and usually is the one you want to choose. This should be straightforward. Fix all conflicts and commit. Advise others that the side branch is no longer to be used. </p><p> -- M.D.S.</p><a href="0010k.htm#rs1">Back to Article</a></body></html>