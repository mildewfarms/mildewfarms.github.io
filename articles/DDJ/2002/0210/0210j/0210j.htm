<html>
<head>
<title>Oct02: Dr. Ecco's Omniheurist Corner</title>
</head>

<body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000">
<!--Copyright &#169; Dr. Dobb's Journal-->

<h1>The DNA on Noah's Arc</h1>
<p><i>Dr. Dobb's Journal</i> October 2002</p>

<h3>By Dennis E. Shasha</h3>

<I>
Dennis is a professor of computer science at New York University. His latest books include Dr. Ecco's Cyberpuzzles: 36 Puzzles for Hackers and Other Mathematical Detectives (W.W. Norton, 2002). He can be contacted at DrEcco@ddj.com.</I>

<hr>

<p>Dr. Windswift was back. "We are cloning, er, higher mammals on our floating laboratory in the South Pacific. The ship is called <i>Noah's Arc</i>, but you must allow a certain poetic license. We don't need two parents for each species, just the sex of interest. We give our mammals certain genetic advantages by inserting specific DNA sent to us by suppliers. We don't completely trust those suppliers, however, so we want to verify the DNA they send.</p>
<p>"To do that, we use a microarray. In each cell of the microarray, we place short sequences of DNA called 'strands.' If we expose the supplied DNA <i>S</i> to the chip, any cell whose strand is a consecutive subsequence of <i>S</i> lights up; no others light up. (Technically, we put the reverse complement of those strands on the microarrays, but the mathematics doesn't change, so let's forget that.)"</p>
<DDJADVERTISEMENT INLINE>

<p>"Genetics&#151;a favorite of mine!" 14-year-old Liane interjected. "When I first found out about fingerprints, I tested some identical twins. Their fingerprints were different!" </p>

<p>We seemed less fascinated by this observation than she. Unperturbed, but in a calmer tone, she proceeded:</p>

<p>"Now, Dr. Windswift, just to make sure we understand the setting: If the sequence <i>S</i> is <i>AGGTCACGTGG</i>, then a strand consisting of <i>CACG</i> will light up, but one consisting of <i>CTCG</i> will not. Similarly, <i>GG</i> will light up, but <i>TT</i> will not. Is that correct?"</p>

<p>"Absolutely, Liane," Windswift answered. "Also, <i>GG</i> will not light up with greater intensity just because it appears twice.</p>

<p>"In general, if I give you a sequence, I would like to know what to put in the cells of my microarray. I would like the maximum length strand to be as short as possible and, within that length, I'd like to use as few strands as possible.</p>

<p>"Oh, I almost forgot. Strands that match the leftmost end of the DNA sequence will light up with a special color, so you'll know which ones those are. Also, by independent means, we can tell you the individual totals of <i>A</i>s, <i>C</i>s, <i>T</i>s, and <i>G</i>s. Here are some questions to train your intuition.</p>

<p>"What is the smallest number of strands needed for an arbitrarily long sequence?"</p>

<p><i></p>

<p>Reader: Please think before you read on.</i></p>


<p>"That's too easy," Liane answered with a chuckle. "Any sequence consisting entirely of a single nucleotide requires no strands at all."</p>

<p>"You're right," Windswift answered. "It was a trick question. Here's a harder one. What is the shortest sequence <i>S</i> you can imagine such that even if strands can be 6 long, you won't be able to verify <i>S</i>?"</p>

<p><i></p>

<p>Reader: Before reading on, would you like to try this one out, too?</i></p>


<p>Liane thought about this for a few minutes. "Suppose <i>S</i> were <i>AAAAAATAAAAAA</i>. With strands of length 6, there would be no way to distinguish between <i>S</i> and <i>S'</i>= <i>AAAAAAATAAAAA</i>. Both <i>S</i> and <i>S'</i> have the same number of <i>A</i>s, the same number of <i>T</i>s, and no strand of length 6 can distinguish one from the other."</p>

<p>"Good job," Windswift said. "But I don't want to be too discouraging. Even small strands can do a good job. For example, if <i>S=ACGAC</i>, then strands of length 2 are enough. Can you see how?"<i></p>

<p>Reader: That's another one to try before you read on.</i></p>


<p>Liane answered quickly, "You place <i>AC, CG, GA, CA,</i> and <i>CC</i> in different cells. You know that there are two <i>A</i>s, two <i>C</i>s, one <i>G</i>, and zero <i>T</i>s. You will see that <i>AC, CG, </i>and <i>GA</i> will light up but <i>CA</i> and <i>CC</i> will not. Further, the special color tells you that <i>AC</i> is at the left end of the sequence. The next letter must be <i>G</i> because <i>CA, CC, </i>and <i>CT</i> are all forbidden. Following <i>G</i>, there is one <i>A</i> and one <i>C</i> left. If <i>GCA</i> comprise the last three nucleotides, then there is no explanation for the fact that <i>GA</i> has lit up. So the last three must be <i>GAC</i>. This should be close to optimal."</p>

<p><i></p>

<p>Reader: Can you confirm or deny the optimality?</p>

<p></i></p>

<p>"Okay, Liane," Windswift continued. "Now, here is the sequence we want to verify: <i>TCACTCGGCTCTCGCACACGGAGATAGCTC</i>. What is the smallest size and the smallest number of strands of that size that would verify this sequence?"</p>

<p><i></p>

<p>Reader: Go for it. The longest strand in Liane's solution was of length 6. There were a lot of tricks she didn't use, however.</i></p>



<h3>Last Month's Solution</h3>


<p>For the original problem, the solution is shown in <A NAME="re1"><A HREF="0210je1.htm">Example 1</A>.</p>


<p>The notation means the following: <i>sc0 </i>is the score you can get from the current node if your adversary has 0 more moves to make, <i>sc1</i> if your adversary has one more move to make, and <i>sc2</i> if your adversary has two more moves to make.</p>

<p>These numbers are derived in a bottom-up fashion. The basic algorithm is this: The 0 score for a node is the maximum of the 0 scores for its children. The 1 score for a node is the minimum of the minimum 0 scores for its children (if adversary chooses now) and the maximum 1 scores for its children (if adversary refrains from choosing).</p>

<p>Similarly, the 2 score for a node is the minimum of the minimum 1 scores for its children (if adversary chooses now) and the maximum 2 scores for its children (if adversary refrains from choosing).</p>



<h3>This Month's Solution</h3>


<p>To verify <i>TCACTCGGCTCTCGCACACGGAGATAGCTC,</i> Liane was able to use 10 strands of length 6 each:</p>


<blockquote><p>
TCACTC</p>

<p>
ACTCGG</p>

<p>TCGGCT</p>

<p>GGCTCT</p>

<p>TCTCGC</p>

<p>CGCACA</p>

<p>CACGGA</p>

<p>GGAGAT</p>

<p>ATAGCT</p>

<p>
TAGCTC</p>

</blockquote>

<h3>A Note to My Colleagues</h3>


<p>This is the last Dr. Ecco column for a while. Dr. Ecco, Liane, and I want to thank you for forming the most imaginative and often ingenious puzzlist community a writer could hope to find. By improving or finding variations on Dr. Ecco's solutions, you made the latest collection of Dr. Ecco's adventures Dr. Ecco's Cyberpuzzles (W.W. Norton &amp; Company, 2002; ISBN 039305120X) one of the most challenging puzzle books ever written. The column topics have ranged from biology to gambling to archaeology. Every time, several readers have discovered the algorithmic key to the core of the problem. You are the elite programmers who create solutions. When doing so, you must combine heuristic thinking with algorithmic knowledge and common sense. I salute you fellow omniheurists. See you soon.</p>


<p>Warm regards,</p>

<p>Dennis Shasha</p>

</body>
</html>
