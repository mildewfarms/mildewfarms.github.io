<html><head><title>January, 2006: Pragmatic Exceptions</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; Dr. Dobb's Journal--><h1>Pragmatic Exceptions</h1><p><i>Dr. Dobb's Journal</i> January, 2006</p><hr><p>Tip #5: Exceptions May Be Poisonous</p><p>Some people eat exceptions. Their rotten delicacy looks something like this:</p> <pre> try{  // something that generates an exception  ...  } catch( Exception x ) {  // do nothing  }</pre>  <p>Sadly, this is more common than good folks should stand for. Eating exceptions   usually assumes that only a certain kind of exception will ever be caught, and   therefore, can be ignored. This is bad for several reasons. </p> <p> For one thing, it breaks the old maxim to use exceptions only for exceptional   cases. For another, it catches unanticipated, &#147;real&#148; exceptions. Even   if these real exceptions don&#146;t cause the system to crash immediately, the   app is now in an unstable state. Heaven help users whose trusted applications   are silently destroying or misrepresenting their data. </p> <p> Modern Java IDEs make the job of printing the stacktrace as easy as typing a   hotkey. There&#146;s simply no excuse for doing anything less than this:</p><pre>  try{  // something that generates an exception  ...  } catch( Exception x ) {  // x.printStackTrace();  }</pre> <p> If you think you've found the rare exception where catching the exception should   be done as a part of control flow, think again. The mistake goes something like   this:</p> <pre> try{  Socket mySocket = new Socket(...);  while( true ) {  // Do some repeating task  ...  if (socket.isClosed()) {  throw new Exception(&quot;socket closed&quot;);  }  }   } catch( Exception x ) {  if (x.getMessage().equals( &quot;secret-catcher-msg&quot;) {  // write some normal program code here<br>  ...  return; // merrily  }  }</pre><p>  The problems with this include:</p><ul><li>   Creating new exceptions for control is wastefully expensive. The entire   stacktrace must be ascertained and stored for each exception thrown.  <li>It makes your code hard to read&#151;people assume that the exception   is just that, an exception, when, in fact, it isn&#146;t. In this case, a closed   socket is an expected condition when users quit using your app.   <li>What happens when you want to throw and catch a real exception? The exception-handling   code becomes increasingly difficult to understand. </ul> <p> You can accomplish the same thing by catching all exception types inside your   loop, then returning the appropriate message for different kinds of exceptions   caught, like this:</p><pre>while( true ) {  try{  // something that generates an exception  ...  } catch( Exception x ) {  if (x instanceof MyExceptionType) {  // Do something special  ...  }   else {  // Do the standard thing  ...  }  }  } </pre> <p> Logging is the obvious way to capture nonfatal exceptions. It&#146;s an appropriate   thing to do when you don&#146;t know how to handle an exception (that you know   you must handle). Logging an exception basically says to users, &#147;Something   went wrong but it&#146;s been handled. If things go wrong, here&#146;s a little   more info.&#148;</p><p>Like paranoid spies trying to cover their tracks, if there&#146;s any doubt   about how to handle an exception after logging it, kill the application. Better   a dead app with a nice logged message than one giving you false data&#150;&#150;or   one just screwing up your data.</p>  <p>&#151;Benjamin Booth<br>  http://www.benjaminbooth.com/</p></body></html>