
<html>
<head>
<title>January, 2006: Single Inheritance  Classes in C</title>
</head>

<body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000">
<!--Copyright &#169; Dr. Dobb's Journal-->






<pre>
MotorData* MotorCtor(void* data, 
                       void(**v)(void)
{
  MotorData* d;
  if (data)
  {
      // This is the base class for a 
      // defined class. The caller has
      // defined both their own 
      // data structure and vtable.
      d = data;
      if (v)
      {
          *v++ = InitPort;
          *v++ = SetSpeed;
          *v++ = GetSpeed;
          *v++ = SetDirection;
          *v++ = GetDirection;
      }
  }
  else
  {
      // This is a standalone 
      // class, and both the 
      // data structure and 
      // vtable must be created here.
      d = Allocate(sizeof(MotorData));
      if (InstCount++ == 0)
      {
        CREATE_VTABLE(Motor, 
                     cMotor, MOTOR);
      }
  }

  // Initialize the class data.
  d-&gt;mPort = NULL;
  d-&gt;mSpeed = 0;
  d-&gt;mDirection = DR_UNKNOWN;

  return d;
}
</pre>

<h4><b>Example 5: </b>Revised Motor constructor. </h4>
<a href="0601o.html#re5">Back to Article</a>


</body>
</html>
