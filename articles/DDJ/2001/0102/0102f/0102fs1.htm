<html><head><title>Feb01: Formula for Repetitive Constants</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; Dr. Dobb's Journal--><h2>Formula for Repetitive Constants</h2><p>Sometimes, when dealing with masks, you need a constant that repeats every few bits. For instance, 0x0F0F0F0F selects the rightmost 4 bits of each byte in a 32-bit word. Extended to 64 bits, such constants can be tedious to write, and it's easy to miscount digits. The following formula is handy for writing such a constant of type <i>long </i>that repeats a value <i>K</i> every <i>N</i> bits, when the word size is a multiple of <i>N</i>: <i>~0UL/((1&lt;&lt;N)-1)*K</i>.</p><p>For example, <i>~0UL/255*0xF</i> generates the mask for the rightmost 4 bits of each byte in a <i>long</i>, as long as the number of bits in a <i>long</i> is a multiple of 8. The formula works because <i>~0UL/ ((1&lt;&lt;N)-1)</i> in binary is a sequence of 1s with period <i>N</i>, for reasons similar to those that cause 9999/9 to generate a sequence of 1s in decimal.</p><DDJADVERTISEMENT INLINE><p> &#151; A.R.</p><a href="0102f.htm#rs1">Back to Article</a></body></html>