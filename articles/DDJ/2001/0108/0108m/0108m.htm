<html><head><title>Aug01: Algorithm Alley</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; Dr. Dobb's Journal--><h1>Orthogonal Sequences</h1><p><i>Dr. Dobb's Journal</i> August 2001</p><h3>By William Stallings</h3><I>William is a consultant, lecturer, and author of over a dozen books on data communications and computer networking. His most recent book is Wireless Communication and Networks (Prentice-Hall, 2001). He can be contacted at http:// www.williamstallings.com/ or ws@shore.net.</I><hr><p>A key element in spread spectrum communication is the use of a spreading sequence. The spreading sequence, <i>c(t)</i>, is a sequence of binary digits shared by the transmitter and receiver. In the common scheme known as direct-sequence spread spectrum (DSSS), spreading consists of multiplying (XOR) the input data by the spreading sequence, where the bit rate of the spreading sequence is higher than that of the input data. When the signal is received, the spreading is removed by multiplying with the same spreading code, exactly synchronized with the received signal.</p><p>The resulting data rate is consequently that of the spreading sequence. This increases the transmitted data rate and therefore increases the required bandwidth. The redundancy of the system is also increased. The spreading codes are chosen so that the resulting signal is noise-like; therefore, there should be an approximately equal number of ones and zeros in the spreading code and few or no repeated patterns.</p><DDJADVERTISEMENT INLINE><p>Several things can be gained from this apparent waste of bandwidth:</p><ul>  <li>You can gain immunity from various kinds of noise and multipath distortion. The earliest applications of spread spectrum were military, where it was used for its immunity to jamming.  <li>It can also be used for hiding and encrypting signals. Only a recipient who knows the spreading code can recover the encoded information.  <li>Several users can independently use the same higher bandwidth with very little interference. This property is used in cellular telephony applications, with a technique known as code division multiplexing (CDM) or code division multiple access (CDMA).</ul><p>When spreading codes are used in a CDMA application, there is the further requirement of lack of correlation. When multiple signals are received, each spread with a different spreading code, the receiver should be able to pick out any individual signal using that signal's spreading code. The spread signals should behave as if they were uncorrelated with each other, so that other signals will appear as noise and not interfere with the despreading of a particular signal. Because of the high degree of redundancy provided by the spreading operation, the despreading operation is able to cope with the interference of other signals in the same bandwidth.</p><p>For example, <A NAME="rf1"><A HREF="0108mf1.htm">Figure 1</A> illustrates a simplified scheme for CDMA encoding and decoding. There are seven logical channels, all using DSSS with a spreading code of 8 bits. Assume that all sources are synchronized. If all seven sources transmit a data bit, in the form of an 8-bit sequence, the signals from all sources combine at the receiver so that two positive or two negative values reinforce and a positive and negative value cancel. To decode a given channel, the receiver multiplies the incoming composite signal by the spreading code for that channel, sums the result, and assigns binary 1 for a positive value and binary 0 for a negative value. In this example, the codes are <i>C</i>0=00000000; <i>C</i>1=01010101; <i>C</i>2=00110011; <i>C</i>3=01100110; <i>C</i>4=00001111; <i>C</i>5=01011010; <i>C</i>6=00111100. It is more convenient here to use +1 and -1 to represent the two binary digits 1 and 0, as in <A NAME="rf1"><A HREF="0108mf1.htm">Figure 1</A>.</p><p>Two general categories of spreading sequences have been used: PN (pseudonoise or pseudorandom number) sequences and orthogonal codes. PN sequences are the most common ones used in FHSS systems and DSSS systems not employing CDMA. In DSSS CDMA systems, both PN and orthogonal codes have been used. In this article, I'll examine orthogonal sequences.</p><h3>Orthogonal Codes</h3><p>Unlike PN sequences, an orthogonal code is a set of sequences in which all pairwise cross correlations are zero. An orthogonal set of sequences is characterized by the equality in <A NAME="re1"><A HREF="0108me1.htm">Example 1</A>(a), where <i>M</i> is the length of each of the sequences in the set, f<i><sub>i</i></sub> and f<i><sub>j</i></sub> are the <i>i</i>th and <i>j</i>th members of the set, and <i>t</i> is the bit duration. </p><p>Both fixed- and variable-length orthogonal codes have been used in CDMA systems. For the CDMA application, each mobile user uses one of the sequences in the set as a spreading code, providing zero cross correlation among all users.</p><h3>Walsh Codes</h3><p>Walsh codes are the most common orthogonal codes used in CDMA applications. A set of Walsh codes of length <i>n</i> consists of the <i>n</i> rows of an <i>n</i>&times;<i>n</i> Walsh matrix. The matrix is defined recursively as in <A NAME="re1"><A HREF="0108me1.htm">Example 1</A>(b), where <i>n</i> is the dimension of the matrix and the overscore denotes the logical NOT of the bits in the matrix. The Walsh matrix has the property that every row is orthogonal to every other row and to the logical NOT of every other row.</p><p><A NAME="rf2"><A HREF="0108mf2.htm">Figure 2</A> shows the Walsh matrices of dimensions 2, 4, and 8. It is easily seen that a bitwise multiplication of any two rows produces 0. For example, in the 8&times;8 matrix, row 3 multiplied by row 4 equals 1+(-1)+1+(-1)+1+(-1)+1+(-1)=0. The example of <A NAME="rf1"><A HREF="0108mf1.htm">Figure 1</A> uses Walsh codes from the 8&times;8 matrix.</p><p>Orthogonal spreading codes such as the Walsh sequences can only be used if all of the users in the same CDMA channel are synchronized to the accuracy of a small fraction of one chip. Because the cross correlation between different shifts of Walsh sequences is not zero, if tight synchronization is not provided, PN sequences are needed.</p><h3>Variable-Length  Orthogonal Codes</h3><p>Third-generation mobile CDMA systems are designed to support users at a number of different data rates. Thus, effective support can be provided by using spreading codes at different rates while maintaining orthogonality. Suppose that the minimum data rate to be supported is <i>R</i><i><sub>min</i></sub> and that all other data rates are related by powers of 2. If a spreading sequence of length <i>N</i> is used for the <i>R</i><i><sub>min</i></sub> data rate, such that each bit of data is spread by <i>N=</i>2<i>n</i> bits of the spreading sequence (transmit the sequence for data bit 0; transmit the complement of the sequence for data bit 1), then the transmitted data rate is <i>NR</i><i><sub>min</i></sub>. For a data rate of 2<i>R</i><i><sub>min</i></sub>, a spreading sequence of length <i>N/</i>2=2<i>n-</i>1 will produce the same output rate of <i>N</i>&times;<i>R</i><i><sub>min</i></sub>. In general, a code length of 2<i>n-k </i>is needed for a bit rate of 2<i>k</i><i>R</i><i><sub>min</i></sub>.</p><p>A set of variable-length orthogonal sequences is readily generated from Walsh matrices of different dimensions. Define the <i>N</i>&times;<i>N</i> matrix <i>C</i><i><sub>N</i></sub> as consisting of <i>N</i> rows, each of length <i>N</i>, labeled <i>C</i><i><sub>N</i></sub>(1), <i>C</i><i><sub>N</i></sub>(2), ..., <i>C</i><i><sub>N</i></sub><i>(N)</i>. With the limitation that <i>N</i> is a power of 2, the matrix <i>C</i><i><sub>N</i></sub> can be recursively generated from the matrix <i>C</i><i><sub>N/</i></sub><sub>2</sub> as in <A NAME="re1"><A HREF="0108me1.htm">Example 1</A>(c). </p><p>Starting with the 1&times;1 Walsh matrix {-1}, <A NAME="rf3"><A HREF="0108mf3.htm">Figure 3</A> shows the results through <i>C</i><sub>8</sub>. Note that each matrix in <A NAME="rf3"><A HREF="0108mf3.htm">Figure 3</A> contains all of the rows of the corresponding Walsh matrix, but in a different order. This ordering is significant for the following reason. Each row <i>C</i><i><sub>N</i></sub><i>(i)</i> of <i>C</i><i><sub>N</i></sub> has the following properties:</p><ul>  <li><i>C</i><i><sub>N</i></sub><i>(i)</i> is orthogonal to all other rows of <i>C</i><i><sub>N</i></sub>.  <li><i>C</i><i><sub>N</i></sub><i>(i)</i> is not orthogonal to a row on the same path of the tree as itself.  <li><i>C</i><i><sub>N</i></sub><i>(i)</i> is orthogonal to all other rows.</ul><p>For example, <i>C</i><sub>8</sub>(4) is not orthogonal to <i>C</i><sub>4</sub>(2), <i>C</i><sub>2</sub>(1), <i>C</i><sub>16</sub>(7), <i>C</i><sub>16</sub>(8), or any other row that appears on the same tree path as itself. If a channel requires a mixture of spreading codes to accommodate different data rates, the selection must be made to avoid rows that are on the same tree path.</p><h3>Multiple Spreading</h3><p>When sufficient bandwidth is available, a multiple spreading technique can prove highly effective. A typical approach is to spread the data rate by an orthogonal code to provide mutual orthogonality among all users in the same cell and to further spread the result by a PN sequence to provide mutual randomness (low cross correlation) between users in different cells. In such a two-stage spreading, the orthogonal codes are referred to as "channelization codes," and the PN codes are referred to as "scrambling codes." For example, this technique is used in the IS-95 Standard. IS-95 is the most widely used second-generation CDMA scheme, primarily deployed in North America.</p><p></p><p><b>DDJ</b></p></body></html>