
<html>
<head>
<title>April, 2005: SharePoint  Web Part Development</title>
</head>

<body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000">
<!--Copyright &#169; Dr. Dobb's Journal-->






<pre>
Private Sub btnSearch_Click(ByVal sender As System.Object, 
                   ByVal e As System.EventArgs) Handles btnSearch.Click
    Dim strConnectionString As String = 
                 "Data Source=(local);Initial Catalog=pubs;
                                    User ID=pubs;Password=search"
    Dim strQuery As String = "SELECT * FROM titles"
    If txtSearch.Text.Length > 0 Then
        strQuery &= " WHERE title LIKE '%" & txtSearch.Text & "%'"
    End If
    Dim objAdapter As New SqlClient.SqlDataAdapter
    objAdapter.SelectCommand = New SqlClient.SqlCommand(strQuery, 
                  New SqlClient.SqlConnection(strConnectionString))
    Dim objDataSet As New DataSet
    objAdapter.Fill(objDataSet)

    grdResults.DataSource = objDataSet.Tables(0)
    grdResults.DataBind()
End Sub</pre>

<h4><b>Example 3:</b><i> Retrieving data and binding to the DataGrid.</i></h4>
<a href="0504l.html#re3">Back to Article</a>


</body>
</html>
