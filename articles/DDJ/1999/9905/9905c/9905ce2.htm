<html><head><title>May99: VBScript and SQL Calendars</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; Dr. Dobb's Journal--><pre><b>(a)</b>&lt;% set rs1=conn.Execute("SELECT DATEPART(mm, RecDate) AS Month, "&amp;_    "DATEPART(dd, RecDate) AS DayOfMonth, DATEPART(dw, "&amp;_    "RecDate) AS WkDay, COUNT(OrderID) AS UnitsSold FROM UnitsSold "&amp;_    "WHERE DATEPART(yyyy, RecDate) = " &amp; wYear &amp; " GROUP BY "&amp;_    "DATEPART(mm, RecDate), " &amp; _    "DATEPART(dd, RecDate), DATEPART(dw, RecDate) "&amp;_    "ORDER BY DATEPART(mm, RecDate), DATEPART(dd, RecDate)") %&gt;<b>(b) </b>&lt;% szSQL = "SELECT DATEPART(mm, RecDate) AS Month, "&amp;_    "DATEPART(dd, RecDate) AS DayOfMonth, DATEPART(dw, "&amp;_    "RecDate) AS WkDay, COUNT(OrderID) AS UnitsSold FROM UnitsSold "&amp;_    "WHERE DATEPART(yyyy, RecDate) = " &amp; wYear &amp; " GROUP BY "&amp;_    "DATEPART(mm, RecDate), " &amp; _    "DATEPART(dd, RecDate), DATEPART(dw, RecDate) "&amp;_    "ORDER BY DATEPART(mm, RecDate), DATEPART(dd, RecDate)" %&gt;&lt;% =szSQL %&gt;&lt;P&gt;&lt;% set rs1=conn.Execute(szSQL) %&gt;</pre><h4>Example 2: Troubleshooting by outputting variables to HTML. (a) Original;  (b) change to.</h4><a href="9905c.htm#re2">Back to Article</a><HR><I>Copyright &copy; 1999, Dr. Dobb's Journal</I><BR>
</body></html>