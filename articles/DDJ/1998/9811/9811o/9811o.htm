<html><head><title>Nov98: Dr. Ecco's Omniheurist Corner</title></head><body bgcolor="FFFFFF"><!--Copyright &#169; Dr. Dobb's Journal--><h1>Directed Evolution</h1><p><i>Dr. Dobb's Journal</i> November 1998</p><h3>By Dennis E. Shasha</h3><I>Dennis, a professor of computer science at New York University, is the author of The Puzzling Adventures of Dr. Ecco (Dover, 1998), and Codes, Puzzles, and Conspiracy (W.H. Freeman &amp; Co., 1992), Database Tuning: A Principled Approach (Prentice Hall, 1992) and (coauthored with Cathy Lazere) Out of Their Minds: The Lives and Discoveries of 15 Great Computer Scientists (Springer Verlag, 1998). He can be contacted at DrEcco@ddj.com.</I><hr><p>Dr. Roger Windswift of the Center for Disease Control had chosen his career of ethnobiologist well. Kayaker, underwater photographer, naturalist, entirely comfortable in the jungle or makeshift lab, he looked cooped in by Ecco's MacDougal Street apartment. After shaking our hands, he paced the room as he described his problem, touching objects to sense their texture without interrupting his train of thought. His story unfolded in academic innocence.</p><p>"In the mid 1980s, Jeffrey Palmer and L.A. Herbon showed that cabbages and turnips, while close in sequence, differ from each other mostly through a series of reversals," he said.</p><p>I saw Ecco's face settle into an expression of bemused indifference. </p><p>"A reversal of a string between positions x and y," Windswift continued, "is a permutation of the string in which the subsequence between <i>x</i> and <i>y</i> is reversed but nothing else is changed. </p><p>So, starting with a string whose indexes are numbered from 0 to <i>n</i>:</p><blockquote><p>0 1 2 3...x x+1...y-1 y y+1...n,</p></blockquote><p>he obtains a new string with a reversal in the middle:</p><blockquote><p>0 1 2 3...y y-1...x+1 x y+1...n.</p></blockquote><p>We denote such permutations by the low and high indexes of the reversed subsequence, in the above case (x,y). For example, given the string <i>abcdefg</i> the reversal (2,4) yields <i>abedcfg</i> (leave <i>ab</i> alone, reverse <i>cde, </i>and leave <i>fg</i> alone).</p><p>"A strain of bacteria closely related to anthrax has recently appeared. We suspect that it was manufactured." </p><p>He stopped his pace for a moment and swept his eyes to each of us.</p><p>Windswift went on. "Fortunately, this particular strain does not appear to be contagious, but we want to be ready for the next one. Our strategy will be to create antidotes by doing reversals of some secret bacteria that we have. This will serve as a kind of vaccine.</p><p>"We have recently developed a technique that will transform a bacteria population A into a new one B that is identical to A except for one reversal that we can control. The technique takes a day to complete. If we want to do five reversals, we will need five days." </p><p>"Is there no way to work on many reversals at the same time?" Liane asked.</p><p>Windswift looked at the 10-year-old girl for a moment, then said, "Good question. As far as we can tell, the answer is no. That's why we're here. We need to create these antidotes as fast as possible. That means we have to figure out the fewest number of reversals to transform some critical protein sequence to another one, all <i>in vivo</i>." </p><p>"Could you give us an example of a reversal problem?" Liane asked.</p><p>"Sure, I'll give one that I had trouble doing efficiently. Find the smallest number of reversals that take <i>abcdefg</i> to <i>cfegbad</i>. I challenge you to do it in three reversals," Windswift answered.</p><p>Liane thought for a minute and then wrote down: </p><blockquote><p>(0,2), producing "cbadefg"</p><p>(1,5), producing "cfedabg"</p><p>(3,6), producing "cfegbad"</p></blockquote><p>"Nice job, Liane," Ecco said chuckling. "Well, Dr. Windswift, you can see we have the talent to do rapid, directed evolution. Please give us a real problem now."</p><p>"Very well," Windswift said. "But please understand that the sequence I'm concerned with is the start of a critical binding sequence for memory. Please be careful not to reveal this information."</p><p>"Yeah, yeah," Ecco said with a smile.</p><p>"Here is the start sequence: </p><blockquote><p>mhtvkllcvvfsclcavawasshrqpchsp</p></blockquote><p>"We want to produce the following sequence through as few reversals as possible:</p><blockquote><p>awavchtfrhsscpchvmsvkllvqlcasp</p></blockquote><p>"Can you do it in under 14 reversals? Two weeks is about all the time we have, but we can do 14 reversals in two weeks."</p><p>Ecco and Liane worked on the problem for a while. Liane came up with a solution first.</p><p>"I can do a few better than you asked for, Dr. Windswift. I've written it down in steps so you can follow it easily. Along with each step, I write the low and high indexes of the subsequence being reversed."</p><p><i>Reader: can you do better than 14? How small a number of reversals can you find?</i></p><p></p><p>"Wow," Windswift said. "Do you have any time after school to do some consulting?"</p><p>"My uncle keeps me busy enough, thanks," Liane answered sweetly.</p><p>Windswift left, but returned a month later. "The anthrax manufacturers have found a new mutation path. Not only can they cause reversals in subsequences, but they can cause subsequences to rotate by one to the right. For example, given the sequence: </p><blockquote><p>abcdefg</p></blockquote><p>the rotation (1,4) would yield</p><blockquote><p>afbcdeg </p></blockquote><p>(the f moves to position 1 and bcde are moved one to the right; remember that the sequence starts at 0). </p><p>Fortunately, we've found a process to do a rotation in a day, but now our mathematical problem is to figure out the shortest possible combination of rotations and reversals to transform one sequence to another. This seems hard to us."</p><p>"Could be. Please let's have a try," Ecco said.</p><p>"Here are the sequences," Windswift said. Start again with:</p><blockquote><p>mhtvkllcvvfsclcavawasshrqpchsp</p></blockquote><p>but end this time with:</p><blockquote><p>mhtcskaavvwalcsfvqpchspshrvcll</p></blockquote><p><i>Reader: Try to find a short sequence of rotations and reversals to get the ending string from the starting string. Remember that the rotations take a subsequence and rotate it by one position to the right.</i></p><p></p><p>Ecco worked on the problem for several minutes in silence. Then he raised his head and asked: "Is there any reason to believe that it is easier to rotate just after reversing?"</p><p>"Not that I know of," Windswift said. "Why do you ask?" </p><p>"No reason, I just suggest you discuss this possibility with your chemists," Ecco said, as he handed Windswift an eight-step transformation.</p><p>Two months later, a small item in a newspaper reported a disease outbreak following a pistachio party in Los Angeles. An unidentified scientist from the Center for Disease Control was on the scene. A few days later, health officials issued an advisory that certain kinds of pistachios should be avoided and a second advisory that people with rashes behind their ears should call CDC in Atlanta. Then the news media returned to its twin obsessions with the stock market and sex scandals.</p><h3>Last Month's Solution</h3><p>Here is what Ecco and Liane came up with after 15 exchanges:</p><blockquote><p>0 0 0 0 0 0 0 0 0 0</p><p>2 2 2 2 0 0 0 0 0 0</p><p>2 2 1 2 2 0 0 0 1 0</p><p>2 2 1 1 2 2 0 1 1 1</p><p>1 1 1 2 2 2 0 1 1 1</p><p>1 2 1 2 2 0 0 1 1 1</p><p>1 2 1 2 0 0 1 1 1 1</p><p>1 2 1 2 0 0 1 1 1 1</p><p>1 2 2 2 2 2 2 2 2 1</p><p>1 1 1 1 1 1 1 1 1 1 </p></blockquote><p>Here were the exchanges:</p><blockquote><p>	1.	exchange (0 8) for (2 6)</p><p>	2.	exchange (0 8) for (5 9)</p><p>	3.	exchange (7 4) for (6 2)</p><p>	4.	exchange (3 8) for (8 3)</p><p>	5.	exchange (8 5) for (6 0)</p><p>	6.	exchange (0 6) for (6 1)</p><p>	7.	exchange (9 0) for (0 3)</p><p>	8.	exchange (9 1) for (3 4)</p><p>	9.	exchange (2 6) for (8 1)</p><p>	10.	exchange (4 7) for (4 5)</p><p>	11.	exchange (9 8) for (1 4)</p><p>	12.	exchange (1 9) for (3 9)</p><p>	13.	exchange (7 8) for (0 5)</p><p>	14.	exchange (9 5) for (2 5)</p><p>	15.	exchange (2 9) for (8 6)</p></blockquote><h3>Reader Notes</h3><p>Readers verified that the best solution with the original scoring to the Mates problem (July 1998) was:</p><blockquote><p>tent 1: alan,mike</p><p>tent 2: dave,isaac,larry</p><p>tent 3: emily,gwenyth,hillary</p><p>tent 4: bob,carol,jack,nick</p><p>tent 5: felicia,kris,olivia,petra</p></blockquote><p>yielding a total score of 175.</p><p>For the case when the campers' preferences dropped by four points (among those with expressed preferences), the best assignment was:</p><blockquote><p>tent 1: alan,issac</p><p>tent 2: carol,jack,nick</p><p>tent 3: kris,larry,mike</p><p>tent 4: bob,felicia,olivia,petra</p><p>tent 5: dave,emily,gwenyth,hillary</p></blockquote><p>yielding a total score of 92 (better than the one Dr. Ecco revealed).</p><p>Paolo Friedli wondered what Dr. Ecco would have done if there had been 60 kids and 20 tents. I suggested simulated annealing, but there are some excellent genetic-algorithm readers out there.</p><p>For example, Mike Williams suggested the following genetic style technique:</p><blockquote><p>arbitrarily assign people to tents</p><p>calculate and store happiness</p><p>repeat</p><p>randomly move some people around</p><p>calculate potential happiness</p><p>if better than previous best</p><blockquote><p>store best and update current configuration</p></blockquote><p>until tired of trying</p></blockquote><p>Readers who solved this problem include:</p><blockquote><p>Gary Knowles </p><p>Michael S. VanVertloo</p><p>Andrew Lipson (who considered the problem a bit easy)</p><p>Terrence E. Vaughn</p><p>Roger Alley</p><p>Jean-Francois Halleux</p><p>Greg Walker</p><p>Jack Boudreau</p><p>Mathew Davies (who thought that Dr. Ecco might be suggesting film titles)</p><p>Carl Smotricz</p><p>Earl Paddon</p><p>Onno Waalewijn</p><p>Yannick Heneault </p><p>Scott McKinney</p><p>Iulian Kakulidis </p><p>Michael Williams </p><p>Manuel Alvarez Fernandez </p><p>Tamas Visegrady </p><p>Paolo Friedli </p><p>Franco Venturi (who also showed that the 	maximum two-day score if one can't 	change bunkmates is 262)</p><p>Dan Falk</p><p>David Seaman</p><p>Lee Thomason</p><p>Steve Worley</p></blockquote><p><b>DDJ</b></p><HR><I>Copyright &copy; 1998, Dr. Dobb's Journal</I><BR>
</body></html>