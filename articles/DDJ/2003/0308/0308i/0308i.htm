<html><head><title>Aug03: Embedded Space</title></head><body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#330066" ALINK="#ff0000" TEXT="#000000"><!--Copyright &#169; Dr. Dobb's Journal--><h1>Robot Lessons</h1><p><i>Dr. Dobb's Journal</i> August 2003</p><h3>By Ed Nisley</h3><I>Ed is an EE, PE, and author in Poughkeepsie, New York. You can contact him at ed.nisley@ieee.org.</I><hr><p>The 10th Annual Trinity Home Firefighting Robots contest took place as scheduled this past April and, despite the conflict in Iraq and widespread concern about SARS, contestants arrived from Israel, China, Canada, and from throughout the U.S. Visa problems eliminated some participants: Iranian students weren't entering the U.S., even without boxes of batteries, wires, and assorted electronic gadgets.</p><p>As in past years, the level of knowledge ranged from novice to expert, with even beginners demonstrating far more competence than you'd expect. Seminar speakers included industry experts and a high-school junior who convincingly demonstrated that she knew more than her elders about the advantages of the HSI color model for object tracking using a video camera. Several lessons of interest to embedded systems folks emerged from the robotics contest and, as if the enthusiastic cheering wasn't loud enough, I have another follow-up on audio systems.</p><DDJADVERTISEMENT INLINE><h3>Firefighting Robotics</h3><p>Many of the robot teams come from junior- and senior-high-schools, as well as home schools. These students are definitely the best of the best and it was a pleasure to watch them at work.</p><p>As I understand it, many Israeli schools incorporate robotics directly into their curriculum. Students begin with simple projects in elementary grades and progress to the point where their high-school robots can qualify for the Trinity contest. The winners of the national contests travel to Connecticut for their "final exam."</p><p>Each team member contributes a specialized bit of the project, from mechanical design to firmware, and this specialization works wonders. A look at the results (http://www.trincoll.edu/events/robot/) shows that the Israeli teams dominate the high-school class.</p><p>The teachers report that robots provide a strong motivation for the math, physics, and chemistry that often seem irrelevant to students. Judging only by the level of enthusiasm and knowledge, it's working for them.</p><p>Recently, I learned that roughly half of the U.S. adult population reads at or below the eighth-grade level, which makes their math and science abilities even worse. This column weighs in at the 10th- to 12th-grade level, so more than half the people in the U.S. will stumble over it.</p><p>Lessons? Anything we can do to promote math and science education is a Good Thing. Make sure your kids can read and write, too. Please?</p><p>Obviously, everybody at the contest could read just fine. <A NAME="rf1"><A HREF="0308if1.htm">Figure 1</A> shows the level of complexity these things can reach: one ultrasonic and four IR rangefinders, a video camera, an ultraviolet flame sensor, three fans, and that's just on the front face. Another robot ran the maze balanced on two wheels in Segway style; even though it wasn't quite fast enough to qualify, it got the "Spirit of an Inventor" award for unbeatable cleverness.</p><p>A Trinity College team entered a robot featuring a single-board PC running Linux with an 802.11b wireless networking link to the team's laptop. A dollop of code let them drive the robot around the gym floor with a joystick on a laptop. This obviously raises some questions about how to assure the judges that it's acting autonomously during the contest, but perhaps they yanked the network card.</p><p>According to rumor, another team cracked the 802.11b network providing Internet access in the building and, within minutes, everybody was on the Web. I don't know if it's true or not, but putting that many bright people together makes things like that happen.</p><h3>Home Robotics</h3><p>The popular conception of a useful robot seems stuck with an animate form factor, as shown by Sony's Aibo (http://www.aibo.com/) dog and Honda's Asimo (http://world.honda.com/ASIMO) humanoid. Joe Jones from iRobot (http://www.irobot.com/) presented a somewhat different approach&#151;make money with robotics and let the form follow the function.</p><p>The iRobot founders hail from the fabled MIT Artificial Intelligence Lab and started their company with a vision of creating useful consumer robots. I infer from their product portfolio where the real money lay, at least in the 1980s and 1990s, as many of their robots sport an unmistakable industrial or military motif.</p><p>Joe presented the softer side of their business with Roomba, the first consumer-grade robot that actually does something useful&#151;it cleans floors (http://www.roombavac.com/). This was such an attractive proposition that I bought one earlier this year, long before I knew he would be describing them at the contest.</p><p>The idea that became Roomba occurred to him in college. He followed the dream through stints at a few companies and finally brought it to fruition at iRobot. He summarized the lessons he learned with a "mission statement" along these lines: Get the job done, do it quickly, and start making money. While that may sound crass, you can't sell an unfinished product (well, an unfinished <i>hardware</i> product, anyway), and if it doesn't actually turn a profit, your company won't survive long enough to try again.</p><p>The Roomba project's guidelines defined a mass-market consumer product priced well under the major-purchase agony level, durable enough for a decent warranty, and simple enough to avoid tech-support hand-holding. As he puts it, this thing is not a computer, it's an appliance&#151;turn it on, push one button, and it starts cleaning.</p><p>Pop Quiz: How often have you seen (or worked on) products designed outside those principles? Essay: How successful were they?</p><p><A NAME="rf2"><A HREF="0308if2.htm">Figure 2</A> shows a Roomba up on wooden blocks showing off its four cliff sensor IR-LEDs for my infrared camera. Notice that it's not even faintly humanoid and it's really, really flat.</p><p><A NAME="rf3"><A HREF="0308if3.htm">Figure 3</A> shows the underside arrangement in visible light. Two powered wheels and a front wheel-skid allow the round body to turn in place, which prevents it from getting caught in corners and under tables. A rotating brush between the two wheels tosses dirt into a rear "particle bin," making it more of a sweeper than a vacuum.</p><p>Early in the development process, iRobot's marketing people pointed out that a floor sweeper had no moxie and, bluntly, if Roomba wasn't a vacuum cleaner, it wouldn't sell. The engineering bears pointed out that real vacuum cleaners required more horsepower than they could get from a battery and that a sweeper could get the job done just as well.</p><p>Anyone who's used a vacuum cleaner understands the problem: You need a high-velocity stream of air to entrain dust particles and carry them into a filter that separates the dirt from the air. Moving lots of high-speed air requires a noisy motor and a line cord; any rationally sized battery just won't suffice.</p><p>Joe related how the Roomba engineering team resolved conflicts with marketing: "Marketing always won!" Why? Because if it doesn't sell, winning a design argument just doesn't matter. Assuming the marketeers are doing their job, they should know more about what consumers want than engineers. Yes, it can happen.</p><p>Roomba now sports a pair of rubber flaps just behind the brush that channel air through a narrow slot to a tiny centrifugal blower and a miniature dust filter. It works perfectly on hardwood floors and reasonably well on carpet, even if you must clean the filter after every use. The marketing people got their "vacuum" keyword and the engineers still finagled over an hour of run time from the battery visible just behind the front wheel.</p><p>Why is it so squat? A useful vacuum must fit beneath the overhang found below kitchen cabinets (called the "toe kick" in kitchen-design parlance). Although other robotic vacuums have come and gone, Roomba is the first one short enough to actually clean the toe kick.</p><p>Joe described the amount of design and testing that went into making Roomba a dependable appliance that doesn't require supervision. Although a low selling price formed a key constraint, they had to add hardware specifically to keep the robot out of trouble.</p><p>Refer back to <A NAME="rf2"><A HREF="0308if2.htm">Figure 2</A> where you'll see four spots of light on the floor under the black bumper. Roomba watches the floor with those four infrared sensors to detect steps and turn away. Each wheel also has a spring-loaded switch that cuts power if it drops over an undetected edge.</p><p>All five of the motors (two wheels, dust brush, spinning whisk, and vacuum) have overload sensors that detect jams or tangles. I can relate from personal experience that these work perfectly, as our Roomba discovered and ate a length of hookup wire under my workbench, then shut down with a sad whimper.</p><p>Although it's impossible to avoid anthropomorphizing the thing, a simple 8-bit, 16-MHz microcontroller handles the whole job. The firmware has several specific "behaviors" that direct it around a room without any internal mapping, predictive searches, or, for that matter, any notion of where the dirt might be.</p><p>It simply wanders around, bumps off obstacles, follows walls, and avoids cliffs for sufficient time to ensure it's blundered through the entire room. Then it shuts down. That's it&#151;no Java, no Internet connection, no video camera, no downloadable code or upgradeable firmware, no programming API, no <i>nothing</i>. It just cleans the room until it's done.</p><p>Joe pointed out that complex controls, fancy algorithms, and exotic sensors invariably produce a brittle system that doesn't respond well to novel situations. The iRobot team deliberately avoided complexity to produce a robot that worked dependably or failed safely in all circumstances.</p><p>Lessons? Keep it simple, make it work, get it out there on the shelves where people can buy it. I think they've got a winner on their hands. Can you say the same?</p><h3>Sound Pressure Level Specsmanship</h3><p>Jason Doege, a reader with experience in designing and installing car stereo systems, points out two ways to achieve those "impossible" in-car sound-pressure levels I disparaged in January.</p><p>The first and perhaps most common method involves quietly changing the Sound Pressure Level (SPL) measurement technique. Speaker sensitivity ratings generally list the SPL in dB-per-watt measured at one meter from the cone. You can get higher numbers than your competitors by simply measuring the SPL closer to the speaker and burying the details in a fine-print footnote. The power-versus-distance relationship doesn't follow the usual inverse-square law, but getting another 10 dB or so just by moving the mic a few feet can't be beat.</p><p>If that's not enough, well, just change the environment. Speaker SPL measurements should occur in free space, but an automobile's interior resembles a sealed box. Measurements in a sealed box produce higher numbers than in open air; those numbers are what it's all about.</p><p>An article in the March 2003 issue of <i>audioXpress</i>, a magazine devoted to do-it-yourself audio (http://www.audioXpress .com/), showed how this works. The pressure variation in a sealed enclosure is proportional to the specific volume change: <img src="delta12.gif"><i>V/V, </i>where the numerator is the change in volume and the denominator is the total enclosure volume. </p><p>A 15-inch-diameter subwoofer with a 19-mm travel (love those mixed units!) displaces roughly 130 cubic inches. A quick Google lookup says a car's cabin might hold 150,000 cubic inches. A specific volume change of 0.001 doesn't sound like a lot, does it? </p><p>To convert that ratio to a pressure you multiply by 1.4&times;10<sup>6</sup> dynes/cm<sup>2</sup>, making a 0.1 percent ratio into 1400 dynes/cm<sup>2</sup>. The magic number depends on the gases, temperatures, and ambient pressures involved, but for ordinary situations, 1.4 million is in the right ballpark.</p><p>The definition of Sound Pressure Level uses a 0 dB reference pressure level of 200 <IMG SRC="mu.gif" ALT="" WIDTH="8" HEIGHT="13">dyne/cm<sup>2</sup>, which makes the SPL calculation look like <A NAME="re1"><A HREF="0308ie1.htm">Example 1</A>, which works out to 137 dB.</p><p>You may adjust that by a few dB to convert from peak to RMS, but remember that higher numbers are more important than full disclosure in advertising. Smaller car cabins will have higher SPLs and SUVs will be lower, but anything over 120 dB is a dangerously high number.</p><p>More bad news arises because the pressure change applies to the entire volume of the cabin, so the SPL does <i>not</i> decrease with the square of the distance from the speaker. Everybody in the cabin, front seat or back, receives the same acoustic abuse. </p><p>If there's any good news, it's that smaller speakers can't pressurize the cabin to the same extent because a speaker's displaced volume varies as the square of the diameter and linearly with the diaphragm's maximum displacement. I suspect most people will also keep the volume down, but a single high-pressure peak can still cause hearing loss.</p><p>So, as Jason points out, my seemingly lighthearted comparison between the Sound Pressure Level of a boomin' system and a Space Shuttle liftoff wasn't that far off. He points out that ordinary car sound systems can, indeed, produce instantaneous and irreversible hearing damage. Even if a standard measurement wouldn't show 140 dB, anything over 120 dB will suffice. Be it so moved and seconded.</p><p>Lessons? Should you be in the delightful position of working with audio for a living, please remember the effect of compression in a sealed chamber and be very afraid. Fast-food lawsuits may be just the thin edge of the legal wedge.</p><h3>Contact Release</h3><p>Laura Wong's original project won an Intel Innovation prize last year and shows more savvy than most techno-verbiage. It's available at http://www.parallax.com/Downloads/Documentation/Where_am_I_Robot_Mapping__Laura_Wong.pdf. You can learn more than you want to know about HSI and RGB color models at http://www.tech.plym.ac.uk/robofoot/robofoot/ vision/software/hsi.html.</p><p>It seems iRobot first tested the consumer waters with My Real Baby, a collaboration with Hasbro toys that lasted about two years. I wouldn't be surprised to discover that some My Real Baby's technology lives on inside Roomba, if only because there is nothing so hard as software.</p><p>Anything with a microcontroller is fair game for hacking and Roomba is no exception. Take a look at http://www.10k.org/jake/mod/roomba/ for the inside story.</p><p>Although I don't have high-fidelity hearing, I do subscribe to <i>audioXpress</i> for information on the electronics and mechanics behind the sound. </p><p><b>DDJ</b></p></body></html>